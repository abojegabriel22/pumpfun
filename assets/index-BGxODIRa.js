import{L as On,P as nr,p as rr}from"./index-BKmMV9en.js";var mt={exports:{}},ir=mt.exports,Pn;function or(){return Pn||(Pn=1,function(i){(function(e,n){i.exports?i.exports=n():(e.nacl||(e.nacl={}),e.nacl.util=n())})(ir,function(){var e={};function n(c){if(!/^(?:[A-Za-z0-9+\/]{2}[A-Za-z0-9+\/]{2})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/.test(c))throw new TypeError("invalid encoding")}return e.decodeUTF8=function(c){if(typeof c!="string")throw new TypeError("expected string");var f,h=unescape(encodeURIComponent(c)),x=new Uint8Array(h.length);for(f=0;f<h.length;f++)x[f]=h.charCodeAt(f);return x},e.encodeUTF8=function(c){var f,h=[];for(f=0;f<c.length;f++)h.push(String.fromCharCode(c[f]));return decodeURIComponent(escape(h.join("")))},typeof atob>"u"?typeof Buffer.from<"u"?(e.encodeBase64=function(c){return Buffer.from(c).toString("base64")},e.decodeBase64=function(c){return n(c),new Uint8Array(Array.prototype.slice.call(Buffer.from(c,"base64"),0))}):(e.encodeBase64=function(c){return new Buffer(c).toString("base64")},e.decodeBase64=function(c){return n(c),new Uint8Array(Array.prototype.slice.call(new Buffer(c,"base64"),0))}):(e.encodeBase64=function(c){var f,h=[],x=c.length;for(f=0;f<x;f++)h.push(String.fromCharCode(c[f]));return btoa(h.join(""))},e.decodeBase64=function(c){n(c);var f,h=atob(c),x=new Uint8Array(h.length);for(f=0;f<h.length;f++)x[f]=h.charCodeAt(f);return x}),e})}(mt)),mt.exports}var sr=or();const Qe=On(sr);var Jt={exports:{}},kn;function ar(){return kn||(kn=1,function(i){(function(e){var n=function(r){var s,o=new Float64Array(16);if(r)for(s=0;s<r.length;s++)o[s]=r[s];return o},c=function(){throw new Error("no PRNG")},f=new Uint8Array(16),h=new Uint8Array(32);h[0]=9;var x=n(),v=n([1]),M=n([56129,1]),B=n([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),re=n([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),X=n([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),de=n([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),xe=n([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function ve(r,s,o,t){r[s]=o>>24&255,r[s+1]=o>>16&255,r[s+2]=o>>8&255,r[s+3]=o&255,r[s+4]=t>>24&255,r[s+5]=t>>16&255,r[s+6]=t>>8&255,r[s+7]=t&255}function _e(r,s,o,t,a){var d,u=0;for(d=0;d<a;d++)u|=r[s+d]^o[t+d];return(1&u-1>>>8)-1}function ot(r,s,o,t){return _e(r,s,o,t,16)}function Ge(r,s,o,t){return _e(r,s,o,t,32)}function kt(r,s,o,t){for(var a=t[0]&255|(t[1]&255)<<8|(t[2]&255)<<16|(t[3]&255)<<24,d=o[0]&255|(o[1]&255)<<8|(o[2]&255)<<16|(o[3]&255)<<24,u=o[4]&255|(o[5]&255)<<8|(o[6]&255)<<16|(o[7]&255)<<24,b=o[8]&255|(o[9]&255)<<8|(o[10]&255)<<16|(o[11]&255)<<24,S=o[12]&255|(o[13]&255)<<8|(o[14]&255)<<16|(o[15]&255)<<24,j=t[4]&255|(t[5]&255)<<8|(t[6]&255)<<16|(t[7]&255)<<24,T=s[0]&255|(s[1]&255)<<8|(s[2]&255)<<16|(s[3]&255)<<24,ee=s[4]&255|(s[5]&255)<<8|(s[6]&255)<<16|(s[7]&255)<<24,U=s[8]&255|(s[9]&255)<<8|(s[10]&255)<<16|(s[11]&255)<<24,N=s[12]&255|(s[13]&255)<<8|(s[14]&255)<<16|(s[15]&255)<<24,K=t[8]&255|(t[9]&255)<<8|(t[10]&255)<<16|(t[11]&255)<<24,$=o[16]&255|(o[17]&255)<<8|(o[18]&255)<<16|(o[19]&255)<<24,F=o[20]&255|(o[21]&255)<<8|(o[22]&255)<<16|(o[23]&255)<<24,D=o[24]&255|(o[25]&255)<<8|(o[26]&255)<<16|(o[27]&255)<<24,q=o[28]&255|(o[29]&255)<<8|(o[30]&255)<<16|(o[31]&255)<<24,O=t[12]&255|(t[13]&255)<<8|(t[14]&255)<<16|(t[15]&255)<<24,A=a,L=d,R=u,P=b,k=S,E=j,p=T,g=ee,w=U,y=N,m=K,_=$,W=F,Y=D,H=q,G=O,l,J=0;J<20;J+=2)l=A+W|0,k^=l<<7|l>>>25,l=k+A|0,w^=l<<9|l>>>23,l=w+k|0,W^=l<<13|l>>>19,l=W+w|0,A^=l<<18|l>>>14,l=E+L|0,y^=l<<7|l>>>25,l=y+E|0,Y^=l<<9|l>>>23,l=Y+y|0,L^=l<<13|l>>>19,l=L+Y|0,E^=l<<18|l>>>14,l=m+p|0,H^=l<<7|l>>>25,l=H+m|0,R^=l<<9|l>>>23,l=R+H|0,p^=l<<13|l>>>19,l=p+R|0,m^=l<<18|l>>>14,l=G+_|0,P^=l<<7|l>>>25,l=P+G|0,g^=l<<9|l>>>23,l=g+P|0,_^=l<<13|l>>>19,l=_+g|0,G^=l<<18|l>>>14,l=A+P|0,L^=l<<7|l>>>25,l=L+A|0,R^=l<<9|l>>>23,l=R+L|0,P^=l<<13|l>>>19,l=P+R|0,A^=l<<18|l>>>14,l=E+k|0,p^=l<<7|l>>>25,l=p+E|0,g^=l<<9|l>>>23,l=g+p|0,k^=l<<13|l>>>19,l=k+g|0,E^=l<<18|l>>>14,l=m+y|0,_^=l<<7|l>>>25,l=_+m|0,w^=l<<9|l>>>23,l=w+_|0,y^=l<<13|l>>>19,l=y+w|0,m^=l<<18|l>>>14,l=G+H|0,W^=l<<7|l>>>25,l=W+G|0,Y^=l<<9|l>>>23,l=Y+W|0,H^=l<<13|l>>>19,l=H+Y|0,G^=l<<18|l>>>14;A=A+a|0,L=L+d|0,R=R+u|0,P=P+b|0,k=k+S|0,E=E+j|0,p=p+T|0,g=g+ee|0,w=w+U|0,y=y+N|0,m=m+K|0,_=_+$|0,W=W+F|0,Y=Y+D|0,H=H+q|0,G=G+O|0,r[0]=A>>>0&255,r[1]=A>>>8&255,r[2]=A>>>16&255,r[3]=A>>>24&255,r[4]=L>>>0&255,r[5]=L>>>8&255,r[6]=L>>>16&255,r[7]=L>>>24&255,r[8]=R>>>0&255,r[9]=R>>>8&255,r[10]=R>>>16&255,r[11]=R>>>24&255,r[12]=P>>>0&255,r[13]=P>>>8&255,r[14]=P>>>16&255,r[15]=P>>>24&255,r[16]=k>>>0&255,r[17]=k>>>8&255,r[18]=k>>>16&255,r[19]=k>>>24&255,r[20]=E>>>0&255,r[21]=E>>>8&255,r[22]=E>>>16&255,r[23]=E>>>24&255,r[24]=p>>>0&255,r[25]=p>>>8&255,r[26]=p>>>16&255,r[27]=p>>>24&255,r[28]=g>>>0&255,r[29]=g>>>8&255,r[30]=g>>>16&255,r[31]=g>>>24&255,r[32]=w>>>0&255,r[33]=w>>>8&255,r[34]=w>>>16&255,r[35]=w>>>24&255,r[36]=y>>>0&255,r[37]=y>>>8&255,r[38]=y>>>16&255,r[39]=y>>>24&255,r[40]=m>>>0&255,r[41]=m>>>8&255,r[42]=m>>>16&255,r[43]=m>>>24&255,r[44]=_>>>0&255,r[45]=_>>>8&255,r[46]=_>>>16&255,r[47]=_>>>24&255,r[48]=W>>>0&255,r[49]=W>>>8&255,r[50]=W>>>16&255,r[51]=W>>>24&255,r[52]=Y>>>0&255,r[53]=Y>>>8&255,r[54]=Y>>>16&255,r[55]=Y>>>24&255,r[56]=H>>>0&255,r[57]=H>>>8&255,r[58]=H>>>16&255,r[59]=H>>>24&255,r[60]=G>>>0&255,r[61]=G>>>8&255,r[62]=G>>>16&255,r[63]=G>>>24&255}function jt(r,s,o,t){for(var a=t[0]&255|(t[1]&255)<<8|(t[2]&255)<<16|(t[3]&255)<<24,d=o[0]&255|(o[1]&255)<<8|(o[2]&255)<<16|(o[3]&255)<<24,u=o[4]&255|(o[5]&255)<<8|(o[6]&255)<<16|(o[7]&255)<<24,b=o[8]&255|(o[9]&255)<<8|(o[10]&255)<<16|(o[11]&255)<<24,S=o[12]&255|(o[13]&255)<<8|(o[14]&255)<<16|(o[15]&255)<<24,j=t[4]&255|(t[5]&255)<<8|(t[6]&255)<<16|(t[7]&255)<<24,T=s[0]&255|(s[1]&255)<<8|(s[2]&255)<<16|(s[3]&255)<<24,ee=s[4]&255|(s[5]&255)<<8|(s[6]&255)<<16|(s[7]&255)<<24,U=s[8]&255|(s[9]&255)<<8|(s[10]&255)<<16|(s[11]&255)<<24,N=s[12]&255|(s[13]&255)<<8|(s[14]&255)<<16|(s[15]&255)<<24,K=t[8]&255|(t[9]&255)<<8|(t[10]&255)<<16|(t[11]&255)<<24,$=o[16]&255|(o[17]&255)<<8|(o[18]&255)<<16|(o[19]&255)<<24,F=o[20]&255|(o[21]&255)<<8|(o[22]&255)<<16|(o[23]&255)<<24,D=o[24]&255|(o[25]&255)<<8|(o[26]&255)<<16|(o[27]&255)<<24,q=o[28]&255|(o[29]&255)<<8|(o[30]&255)<<16|(o[31]&255)<<24,O=t[12]&255|(t[13]&255)<<8|(t[14]&255)<<16|(t[15]&255)<<24,A=a,L=d,R=u,P=b,k=S,E=j,p=T,g=ee,w=U,y=N,m=K,_=$,W=F,Y=D,H=q,G=O,l,J=0;J<20;J+=2)l=A+W|0,k^=l<<7|l>>>25,l=k+A|0,w^=l<<9|l>>>23,l=w+k|0,W^=l<<13|l>>>19,l=W+w|0,A^=l<<18|l>>>14,l=E+L|0,y^=l<<7|l>>>25,l=y+E|0,Y^=l<<9|l>>>23,l=Y+y|0,L^=l<<13|l>>>19,l=L+Y|0,E^=l<<18|l>>>14,l=m+p|0,H^=l<<7|l>>>25,l=H+m|0,R^=l<<9|l>>>23,l=R+H|0,p^=l<<13|l>>>19,l=p+R|0,m^=l<<18|l>>>14,l=G+_|0,P^=l<<7|l>>>25,l=P+G|0,g^=l<<9|l>>>23,l=g+P|0,_^=l<<13|l>>>19,l=_+g|0,G^=l<<18|l>>>14,l=A+P|0,L^=l<<7|l>>>25,l=L+A|0,R^=l<<9|l>>>23,l=R+L|0,P^=l<<13|l>>>19,l=P+R|0,A^=l<<18|l>>>14,l=E+k|0,p^=l<<7|l>>>25,l=p+E|0,g^=l<<9|l>>>23,l=g+p|0,k^=l<<13|l>>>19,l=k+g|0,E^=l<<18|l>>>14,l=m+y|0,_^=l<<7|l>>>25,l=_+m|0,w^=l<<9|l>>>23,l=w+_|0,y^=l<<13|l>>>19,l=y+w|0,m^=l<<18|l>>>14,l=G+H|0,W^=l<<7|l>>>25,l=W+G|0,Y^=l<<9|l>>>23,l=Y+W|0,H^=l<<13|l>>>19,l=H+Y|0,G^=l<<18|l>>>14;r[0]=A>>>0&255,r[1]=A>>>8&255,r[2]=A>>>16&255,r[3]=A>>>24&255,r[4]=E>>>0&255,r[5]=E>>>8&255,r[6]=E>>>16&255,r[7]=E>>>24&255,r[8]=m>>>0&255,r[9]=m>>>8&255,r[10]=m>>>16&255,r[11]=m>>>24&255,r[12]=G>>>0&255,r[13]=G>>>8&255,r[14]=G>>>16&255,r[15]=G>>>24&255,r[16]=p>>>0&255,r[17]=p>>>8&255,r[18]=p>>>16&255,r[19]=p>>>24&255,r[20]=g>>>0&255,r[21]=g>>>8&255,r[22]=g>>>16&255,r[23]=g>>>24&255,r[24]=w>>>0&255,r[25]=w>>>8&255,r[26]=w>>>16&255,r[27]=w>>>24&255,r[28]=y>>>0&255,r[29]=y>>>8&255,r[30]=y>>>16&255,r[31]=y>>>24&255}function st(r,s,o,t){kt(r,s,o,t)}function at(r,s,o,t){jt(r,s,o,t)}var Le=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function hn(r,s,o,t,a,d,u){var b=new Uint8Array(16),S=new Uint8Array(64),j,T;for(T=0;T<16;T++)b[T]=0;for(T=0;T<8;T++)b[T]=d[T];for(;a>=64;){for(st(S,b,u,Le),T=0;T<64;T++)r[s+T]=o[t+T]^S[T];for(j=1,T=8;T<16;T++)j=j+(b[T]&255)|0,b[T]=j&255,j>>>=8;a-=64,s+=64,t+=64}if(a>0)for(st(S,b,u,Le),T=0;T<a;T++)r[s+T]=o[t+T]^S[T];return 0}function pn(r,s,o,t,a){var d=new Uint8Array(16),u=new Uint8Array(64),b,S;for(S=0;S<16;S++)d[S]=0;for(S=0;S<8;S++)d[S]=t[S];for(;o>=64;){for(st(u,d,a,Le),S=0;S<64;S++)r[s+S]=u[S];for(b=1,S=8;S<16;S++)b=b+(d[S]&255)|0,d[S]=b&255,b>>>=8;o-=64,s+=64}if(o>0)for(st(u,d,a,Le),S=0;S<o;S++)r[s+S]=u[S];return 0}function gn(r,s,o,t,a){var d=new Uint8Array(32);at(d,t,a,Le);for(var u=new Uint8Array(8),b=0;b<8;b++)u[b]=t[b+16];return pn(r,s,o,u,d)}function It(r,s,o,t,a,d,u){var b=new Uint8Array(32);at(b,d,u,Le);for(var S=new Uint8Array(8),j=0;j<8;j++)S[j]=d[j+16];return hn(r,s,o,t,a,S,b)}var ct=function(r){this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0;var s,o,t,a,d,u,b,S;s=r[0]&255|(r[1]&255)<<8,this.r[0]=s&8191,o=r[2]&255|(r[3]&255)<<8,this.r[1]=(s>>>13|o<<3)&8191,t=r[4]&255|(r[5]&255)<<8,this.r[2]=(o>>>10|t<<6)&7939,a=r[6]&255|(r[7]&255)<<8,this.r[3]=(t>>>7|a<<9)&8191,d=r[8]&255|(r[9]&255)<<8,this.r[4]=(a>>>4|d<<12)&255,this.r[5]=d>>>1&8190,u=r[10]&255|(r[11]&255)<<8,this.r[6]=(d>>>14|u<<2)&8191,b=r[12]&255|(r[13]&255)<<8,this.r[7]=(u>>>11|b<<5)&8065,S=r[14]&255|(r[15]&255)<<8,this.r[8]=(b>>>8|S<<8)&8191,this.r[9]=S>>>5&127,this.pad[0]=r[16]&255|(r[17]&255)<<8,this.pad[1]=r[18]&255|(r[19]&255)<<8,this.pad[2]=r[20]&255|(r[21]&255)<<8,this.pad[3]=r[22]&255|(r[23]&255)<<8,this.pad[4]=r[24]&255|(r[25]&255)<<8,this.pad[5]=r[26]&255|(r[27]&255)<<8,this.pad[6]=r[28]&255|(r[29]&255)<<8,this.pad[7]=r[30]&255|(r[31]&255)<<8};ct.prototype.blocks=function(r,s,o){for(var t=this.fin?0:2048,a,d,u,b,S,j,T,ee,U,N,K,$,F,D,q,O,A,L,R,P=this.h[0],k=this.h[1],E=this.h[2],p=this.h[3],g=this.h[4],w=this.h[5],y=this.h[6],m=this.h[7],_=this.h[8],W=this.h[9],Y=this.r[0],H=this.r[1],G=this.r[2],l=this.r[3],J=this.r[4],te=this.r[5],ne=this.r[6],z=this.r[7],V=this.r[8],Q=this.r[9];o>=16;)a=r[s+0]&255|(r[s+1]&255)<<8,P+=a&8191,d=r[s+2]&255|(r[s+3]&255)<<8,k+=(a>>>13|d<<3)&8191,u=r[s+4]&255|(r[s+5]&255)<<8,E+=(d>>>10|u<<6)&8191,b=r[s+6]&255|(r[s+7]&255)<<8,p+=(u>>>7|b<<9)&8191,S=r[s+8]&255|(r[s+9]&255)<<8,g+=(b>>>4|S<<12)&8191,w+=S>>>1&8191,j=r[s+10]&255|(r[s+11]&255)<<8,y+=(S>>>14|j<<2)&8191,T=r[s+12]&255|(r[s+13]&255)<<8,m+=(j>>>11|T<<5)&8191,ee=r[s+14]&255|(r[s+15]&255)<<8,_+=(T>>>8|ee<<8)&8191,W+=ee>>>5|t,U=0,N=U,N+=P*Y,N+=k*(5*Q),N+=E*(5*V),N+=p*(5*z),N+=g*(5*ne),U=N>>>13,N&=8191,N+=w*(5*te),N+=y*(5*J),N+=m*(5*l),N+=_*(5*G),N+=W*(5*H),U+=N>>>13,N&=8191,K=U,K+=P*H,K+=k*Y,K+=E*(5*Q),K+=p*(5*V),K+=g*(5*z),U=K>>>13,K&=8191,K+=w*(5*ne),K+=y*(5*te),K+=m*(5*J),K+=_*(5*l),K+=W*(5*G),U+=K>>>13,K&=8191,$=U,$+=P*G,$+=k*H,$+=E*Y,$+=p*(5*Q),$+=g*(5*V),U=$>>>13,$&=8191,$+=w*(5*z),$+=y*(5*ne),$+=m*(5*te),$+=_*(5*J),$+=W*(5*l),U+=$>>>13,$&=8191,F=U,F+=P*l,F+=k*G,F+=E*H,F+=p*Y,F+=g*(5*Q),U=F>>>13,F&=8191,F+=w*(5*V),F+=y*(5*z),F+=m*(5*ne),F+=_*(5*te),F+=W*(5*J),U+=F>>>13,F&=8191,D=U,D+=P*J,D+=k*l,D+=E*G,D+=p*H,D+=g*Y,U=D>>>13,D&=8191,D+=w*(5*Q),D+=y*(5*V),D+=m*(5*z),D+=_*(5*ne),D+=W*(5*te),U+=D>>>13,D&=8191,q=U,q+=P*te,q+=k*J,q+=E*l,q+=p*G,q+=g*H,U=q>>>13,q&=8191,q+=w*Y,q+=y*(5*Q),q+=m*(5*V),q+=_*(5*z),q+=W*(5*ne),U+=q>>>13,q&=8191,O=U,O+=P*ne,O+=k*te,O+=E*J,O+=p*l,O+=g*G,U=O>>>13,O&=8191,O+=w*H,O+=y*Y,O+=m*(5*Q),O+=_*(5*V),O+=W*(5*z),U+=O>>>13,O&=8191,A=U,A+=P*z,A+=k*ne,A+=E*te,A+=p*J,A+=g*l,U=A>>>13,A&=8191,A+=w*G,A+=y*H,A+=m*Y,A+=_*(5*Q),A+=W*(5*V),U+=A>>>13,A&=8191,L=U,L+=P*V,L+=k*z,L+=E*ne,L+=p*te,L+=g*J,U=L>>>13,L&=8191,L+=w*l,L+=y*G,L+=m*H,L+=_*Y,L+=W*(5*Q),U+=L>>>13,L&=8191,R=U,R+=P*Q,R+=k*V,R+=E*z,R+=p*ne,R+=g*te,U=R>>>13,R&=8191,R+=w*J,R+=y*l,R+=m*G,R+=_*H,R+=W*Y,U+=R>>>13,R&=8191,U=(U<<2)+U|0,U=U+N|0,N=U&8191,U=U>>>13,K+=U,P=N,k=K,E=$,p=F,g=D,w=q,y=O,m=A,_=L,W=R,s+=16,o-=16;this.h[0]=P,this.h[1]=k,this.h[2]=E,this.h[3]=p,this.h[4]=g,this.h[5]=w,this.h[6]=y,this.h[7]=m,this.h[8]=_,this.h[9]=W},ct.prototype.finish=function(r,s){var o=new Uint16Array(10),t,a,d,u;if(this.leftover){for(u=this.leftover,this.buffer[u++]=1;u<16;u++)this.buffer[u]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(t=this.h[1]>>>13,this.h[1]&=8191,u=2;u<10;u++)this.h[u]+=t,t=this.h[u]>>>13,this.h[u]&=8191;for(this.h[0]+=t*5,t=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=t,t=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=t,o[0]=this.h[0]+5,t=o[0]>>>13,o[0]&=8191,u=1;u<10;u++)o[u]=this.h[u]+t,t=o[u]>>>13,o[u]&=8191;for(o[9]-=8192,a=(t^1)-1,u=0;u<10;u++)o[u]&=a;for(a=~a,u=0;u<10;u++)this.h[u]=this.h[u]&a|o[u];for(this.h[0]=(this.h[0]|this.h[1]<<13)&65535,this.h[1]=(this.h[1]>>>3|this.h[2]<<10)&65535,this.h[2]=(this.h[2]>>>6|this.h[3]<<7)&65535,this.h[3]=(this.h[3]>>>9|this.h[4]<<4)&65535,this.h[4]=(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14)&65535,this.h[5]=(this.h[6]>>>2|this.h[7]<<11)&65535,this.h[6]=(this.h[7]>>>5|this.h[8]<<8)&65535,this.h[7]=(this.h[8]>>>8|this.h[9]<<5)&65535,d=this.h[0]+this.pad[0],this.h[0]=d&65535,u=1;u<8;u++)d=(this.h[u]+this.pad[u]|0)+(d>>>16)|0,this.h[u]=d&65535;r[s+0]=this.h[0]>>>0&255,r[s+1]=this.h[0]>>>8&255,r[s+2]=this.h[1]>>>0&255,r[s+3]=this.h[1]>>>8&255,r[s+4]=this.h[2]>>>0&255,r[s+5]=this.h[2]>>>8&255,r[s+6]=this.h[3]>>>0&255,r[s+7]=this.h[3]>>>8&255,r[s+8]=this.h[4]>>>0&255,r[s+9]=this.h[4]>>>8&255,r[s+10]=this.h[5]>>>0&255,r[s+11]=this.h[5]>>>8&255,r[s+12]=this.h[6]>>>0&255,r[s+13]=this.h[6]>>>8&255,r[s+14]=this.h[7]>>>0&255,r[s+15]=this.h[7]>>>8&255},ct.prototype.update=function(r,s,o){var t,a;if(this.leftover){for(a=16-this.leftover,a>o&&(a=o),t=0;t<a;t++)this.buffer[this.leftover+t]=r[s+t];if(o-=a,s+=a,this.leftover+=a,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(o>=16&&(a=o-o%16,this.blocks(r,s,a),s+=a,o-=a),o){for(t=0;t<o;t++)this.buffer[this.leftover+t]=r[s+t];this.leftover+=o}};function Lt(r,s,o,t,a,d){var u=new ct(d);return u.update(o,t,a),u.finish(r,s),0}function xn(r,s,o,t,a,d){var u=new Uint8Array(16);return Lt(u,0,o,t,a,d),ot(r,s,u,0)}function Mt(r,s,o,t,a){var d;if(o<32)return-1;for(It(r,0,s,0,o,t,a),Lt(r,16,r,32,o-32,r),d=0;d<16;d++)r[d]=0;return 0}function Wt(r,s,o,t,a){var d,u=new Uint8Array(32);if(o<32||(gn(u,0,32,t,a),xn(s,16,s,32,o-32,u)!==0))return-1;for(It(r,0,s,0,o,t,a),d=0;d<32;d++)r[d]=0;return 0}function Re(r,s){var o;for(o=0;o<16;o++)r[o]=s[o]|0}function Bt(r){var s,o,t=1;for(s=0;s<16;s++)o=r[s]+t+65535,t=Math.floor(o/65536),r[s]=o-t*65536;r[0]+=t-1+37*(t-1)}function Ne(r,s,o){for(var t,a=~(o-1),d=0;d<16;d++)t=a&(r[d]^s[d]),r[d]^=t,s[d]^=t}function Ke(r,s){var o,t,a,d=n(),u=n();for(o=0;o<16;o++)u[o]=s[o];for(Bt(u),Bt(u),Bt(u),t=0;t<2;t++){for(d[0]=u[0]-65517,o=1;o<15;o++)d[o]=u[o]-65535-(d[o-1]>>16&1),d[o-1]&=65535;d[15]=u[15]-32767-(d[14]>>16&1),a=d[15]>>16&1,d[14]&=65535,Ne(u,d,1-a)}for(o=0;o<16;o++)r[2*o]=u[o]&255,r[2*o+1]=u[o]>>8}function vn(r,s){var o=new Uint8Array(32),t=new Uint8Array(32);return Ke(o,r),Ke(t,s),Ge(o,0,t,0)}function yn(r){var s=new Uint8Array(32);return Ke(s,r),s[0]&1}function Nt(r,s){var o;for(o=0;o<16;o++)r[o]=s[2*o]+(s[2*o+1]<<8);r[15]&=32767}function Se(r,s,o){for(var t=0;t<16;t++)r[t]=s[t]+o[t]}function Ee(r,s,o){for(var t=0;t<16;t++)r[t]=s[t]-o[t]}function Z(r,s,o){var t,a,d=0,u=0,b=0,S=0,j=0,T=0,ee=0,U=0,N=0,K=0,$=0,F=0,D=0,q=0,O=0,A=0,L=0,R=0,P=0,k=0,E=0,p=0,g=0,w=0,y=0,m=0,_=0,W=0,Y=0,H=0,G=0,l=o[0],J=o[1],te=o[2],ne=o[3],z=o[4],V=o[5],Q=o[6],ce=o[7],ie=o[8],oe=o[9],se=o[10],ae=o[11],fe=o[12],ue=o[13],he=o[14],pe=o[15];t=s[0],d+=t*l,u+=t*J,b+=t*te,S+=t*ne,j+=t*z,T+=t*V,ee+=t*Q,U+=t*ce,N+=t*ie,K+=t*oe,$+=t*se,F+=t*ae,D+=t*fe,q+=t*ue,O+=t*he,A+=t*pe,t=s[1],u+=t*l,b+=t*J,S+=t*te,j+=t*ne,T+=t*z,ee+=t*V,U+=t*Q,N+=t*ce,K+=t*ie,$+=t*oe,F+=t*se,D+=t*ae,q+=t*fe,O+=t*ue,A+=t*he,L+=t*pe,t=s[2],b+=t*l,S+=t*J,j+=t*te,T+=t*ne,ee+=t*z,U+=t*V,N+=t*Q,K+=t*ce,$+=t*ie,F+=t*oe,D+=t*se,q+=t*ae,O+=t*fe,A+=t*ue,L+=t*he,R+=t*pe,t=s[3],S+=t*l,j+=t*J,T+=t*te,ee+=t*ne,U+=t*z,N+=t*V,K+=t*Q,$+=t*ce,F+=t*ie,D+=t*oe,q+=t*se,O+=t*ae,A+=t*fe,L+=t*ue,R+=t*he,P+=t*pe,t=s[4],j+=t*l,T+=t*J,ee+=t*te,U+=t*ne,N+=t*z,K+=t*V,$+=t*Q,F+=t*ce,D+=t*ie,q+=t*oe,O+=t*se,A+=t*ae,L+=t*fe,R+=t*ue,P+=t*he,k+=t*pe,t=s[5],T+=t*l,ee+=t*J,U+=t*te,N+=t*ne,K+=t*z,$+=t*V,F+=t*Q,D+=t*ce,q+=t*ie,O+=t*oe,A+=t*se,L+=t*ae,R+=t*fe,P+=t*ue,k+=t*he,E+=t*pe,t=s[6],ee+=t*l,U+=t*J,N+=t*te,K+=t*ne,$+=t*z,F+=t*V,D+=t*Q,q+=t*ce,O+=t*ie,A+=t*oe,L+=t*se,R+=t*ae,P+=t*fe,k+=t*ue,E+=t*he,p+=t*pe,t=s[7],U+=t*l,N+=t*J,K+=t*te,$+=t*ne,F+=t*z,D+=t*V,q+=t*Q,O+=t*ce,A+=t*ie,L+=t*oe,R+=t*se,P+=t*ae,k+=t*fe,E+=t*ue,p+=t*he,g+=t*pe,t=s[8],N+=t*l,K+=t*J,$+=t*te,F+=t*ne,D+=t*z,q+=t*V,O+=t*Q,A+=t*ce,L+=t*ie,R+=t*oe,P+=t*se,k+=t*ae,E+=t*fe,p+=t*ue,g+=t*he,w+=t*pe,t=s[9],K+=t*l,$+=t*J,F+=t*te,D+=t*ne,q+=t*z,O+=t*V,A+=t*Q,L+=t*ce,R+=t*ie,P+=t*oe,k+=t*se,E+=t*ae,p+=t*fe,g+=t*ue,w+=t*he,y+=t*pe,t=s[10],$+=t*l,F+=t*J,D+=t*te,q+=t*ne,O+=t*z,A+=t*V,L+=t*Q,R+=t*ce,P+=t*ie,k+=t*oe,E+=t*se,p+=t*ae,g+=t*fe,w+=t*ue,y+=t*he,m+=t*pe,t=s[11],F+=t*l,D+=t*J,q+=t*te,O+=t*ne,A+=t*z,L+=t*V,R+=t*Q,P+=t*ce,k+=t*ie,E+=t*oe,p+=t*se,g+=t*ae,w+=t*fe,y+=t*ue,m+=t*he,_+=t*pe,t=s[12],D+=t*l,q+=t*J,O+=t*te,A+=t*ne,L+=t*z,R+=t*V,P+=t*Q,k+=t*ce,E+=t*ie,p+=t*oe,g+=t*se,w+=t*ae,y+=t*fe,m+=t*ue,_+=t*he,W+=t*pe,t=s[13],q+=t*l,O+=t*J,A+=t*te,L+=t*ne,R+=t*z,P+=t*V,k+=t*Q,E+=t*ce,p+=t*ie,g+=t*oe,w+=t*se,y+=t*ae,m+=t*fe,_+=t*ue,W+=t*he,Y+=t*pe,t=s[14],O+=t*l,A+=t*J,L+=t*te,R+=t*ne,P+=t*z,k+=t*V,E+=t*Q,p+=t*ce,g+=t*ie,w+=t*oe,y+=t*se,m+=t*ae,_+=t*fe,W+=t*ue,Y+=t*he,H+=t*pe,t=s[15],A+=t*l,L+=t*J,R+=t*te,P+=t*ne,k+=t*z,E+=t*V,p+=t*Q,g+=t*ce,w+=t*ie,y+=t*oe,m+=t*se,_+=t*ae,W+=t*fe,Y+=t*ue,H+=t*he,G+=t*pe,d+=38*L,u+=38*R,b+=38*P,S+=38*k,j+=38*E,T+=38*p,ee+=38*g,U+=38*w,N+=38*y,K+=38*m,$+=38*_,F+=38*W,D+=38*Y,q+=38*H,O+=38*G,a=1,t=d+a+65535,a=Math.floor(t/65536),d=t-a*65536,t=u+a+65535,a=Math.floor(t/65536),u=t-a*65536,t=b+a+65535,a=Math.floor(t/65536),b=t-a*65536,t=S+a+65535,a=Math.floor(t/65536),S=t-a*65536,t=j+a+65535,a=Math.floor(t/65536),j=t-a*65536,t=T+a+65535,a=Math.floor(t/65536),T=t-a*65536,t=ee+a+65535,a=Math.floor(t/65536),ee=t-a*65536,t=U+a+65535,a=Math.floor(t/65536),U=t-a*65536,t=N+a+65535,a=Math.floor(t/65536),N=t-a*65536,t=K+a+65535,a=Math.floor(t/65536),K=t-a*65536,t=$+a+65535,a=Math.floor(t/65536),$=t-a*65536,t=F+a+65535,a=Math.floor(t/65536),F=t-a*65536,t=D+a+65535,a=Math.floor(t/65536),D=t-a*65536,t=q+a+65535,a=Math.floor(t/65536),q=t-a*65536,t=O+a+65535,a=Math.floor(t/65536),O=t-a*65536,t=A+a+65535,a=Math.floor(t/65536),A=t-a*65536,d+=a-1+37*(a-1),a=1,t=d+a+65535,a=Math.floor(t/65536),d=t-a*65536,t=u+a+65535,a=Math.floor(t/65536),u=t-a*65536,t=b+a+65535,a=Math.floor(t/65536),b=t-a*65536,t=S+a+65535,a=Math.floor(t/65536),S=t-a*65536,t=j+a+65535,a=Math.floor(t/65536),j=t-a*65536,t=T+a+65535,a=Math.floor(t/65536),T=t-a*65536,t=ee+a+65535,a=Math.floor(t/65536),ee=t-a*65536,t=U+a+65535,a=Math.floor(t/65536),U=t-a*65536,t=N+a+65535,a=Math.floor(t/65536),N=t-a*65536,t=K+a+65535,a=Math.floor(t/65536),K=t-a*65536,t=$+a+65535,a=Math.floor(t/65536),$=t-a*65536,t=F+a+65535,a=Math.floor(t/65536),F=t-a*65536,t=D+a+65535,a=Math.floor(t/65536),D=t-a*65536,t=q+a+65535,a=Math.floor(t/65536),q=t-a*65536,t=O+a+65535,a=Math.floor(t/65536),O=t-a*65536,t=A+a+65535,a=Math.floor(t/65536),A=t-a*65536,d+=a-1+37*(a-1),r[0]=d,r[1]=u,r[2]=b,r[3]=S,r[4]=j,r[5]=T,r[6]=ee,r[7]=U,r[8]=N,r[9]=K,r[10]=$,r[11]=F,r[12]=D,r[13]=q,r[14]=O,r[15]=A}function me(r,s){Z(r,s,s)}function bn(r,s){var o=n(),t;for(t=0;t<16;t++)o[t]=s[t];for(t=253;t>=0;t--)me(o,o),t!==2&&t!==4&&Z(o,o,s);for(t=0;t<16;t++)r[t]=o[t]}function mn(r,s){var o=n(),t;for(t=0;t<16;t++)o[t]=s[t];for(t=250;t>=0;t--)me(o,o),t!==1&&Z(o,o,s);for(t=0;t<16;t++)r[t]=o[t]}function ft(r,s,o){var t=new Uint8Array(32),a=new Float64Array(80),d,u,b=n(),S=n(),j=n(),T=n(),ee=n(),U=n();for(u=0;u<31;u++)t[u]=s[u];for(t[31]=s[31]&127|64,t[0]&=248,Nt(a,o),u=0;u<16;u++)S[u]=a[u],T[u]=b[u]=j[u]=0;for(b[0]=T[0]=1,u=254;u>=0;--u)d=t[u>>>3]>>>(u&7)&1,Ne(b,S,d),Ne(j,T,d),Se(ee,b,j),Ee(b,b,j),Se(j,S,T),Ee(S,S,T),me(T,ee),me(U,b),Z(b,j,b),Z(j,S,ee),Se(ee,b,j),Ee(b,b,j),me(S,b),Ee(j,T,U),Z(b,j,M),Se(b,b,T),Z(j,j,b),Z(b,T,U),Z(T,S,a),me(S,ee),Ne(b,S,d),Ne(j,T,d);for(u=0;u<16;u++)a[u+16]=b[u],a[u+32]=j[u],a[u+48]=S[u],a[u+64]=T[u];var N=a.subarray(32),K=a.subarray(16);return bn(N,N),Z(K,K,N),Ke(r,K),0}function lt(r,s){return ft(r,s,h)}function wn(r,s){return c(s,32),lt(r,s)}function dt(r,s,o){var t=new Uint8Array(32);return ft(t,o,s),at(r,f,t,Le)}var _n=Mt,Jn=Wt;function Xn(r,s,o,t,a,d){var u=new Uint8Array(32);return dt(u,a,d),_n(r,s,o,t,u)}function Zn(r,s,o,t,a,d){var u=new Uint8Array(32);return dt(u,a,d),Jn(r,s,o,t,u)}var Sn=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function En(r,s,o,t){for(var a=new Int32Array(16),d=new Int32Array(16),u,b,S,j,T,ee,U,N,K,$,F,D,q,O,A,L,R,P,k,E,p,g,w,y,m,_,W=r[0],Y=r[1],H=r[2],G=r[3],l=r[4],J=r[5],te=r[6],ne=r[7],z=s[0],V=s[1],Q=s[2],ce=s[3],ie=s[4],oe=s[5],se=s[6],ae=s[7],fe=0;t>=128;){for(k=0;k<16;k++)E=8*k+fe,a[k]=o[E+0]<<24|o[E+1]<<16|o[E+2]<<8|o[E+3],d[k]=o[E+4]<<24|o[E+5]<<16|o[E+6]<<8|o[E+7];for(k=0;k<80;k++)if(u=W,b=Y,S=H,j=G,T=l,ee=J,U=te,N=ne,K=z,$=V,F=Q,D=ce,q=ie,O=oe,A=se,L=ae,p=ne,g=ae,w=g&65535,y=g>>>16,m=p&65535,_=p>>>16,p=(l>>>14|ie<<18)^(l>>>18|ie<<14)^(ie>>>9|l<<23),g=(ie>>>14|l<<18)^(ie>>>18|l<<14)^(l>>>9|ie<<23),w+=g&65535,y+=g>>>16,m+=p&65535,_+=p>>>16,p=l&J^~l&te,g=ie&oe^~ie&se,w+=g&65535,y+=g>>>16,m+=p&65535,_+=p>>>16,p=Sn[k*2],g=Sn[k*2+1],w+=g&65535,y+=g>>>16,m+=p&65535,_+=p>>>16,p=a[k%16],g=d[k%16],w+=g&65535,y+=g>>>16,m+=p&65535,_+=p>>>16,y+=w>>>16,m+=y>>>16,_+=m>>>16,R=m&65535|_<<16,P=w&65535|y<<16,p=R,g=P,w=g&65535,y=g>>>16,m=p&65535,_=p>>>16,p=(W>>>28|z<<4)^(z>>>2|W<<30)^(z>>>7|W<<25),g=(z>>>28|W<<4)^(W>>>2|z<<30)^(W>>>7|z<<25),w+=g&65535,y+=g>>>16,m+=p&65535,_+=p>>>16,p=W&Y^W&H^Y&H,g=z&V^z&Q^V&Q,w+=g&65535,y+=g>>>16,m+=p&65535,_+=p>>>16,y+=w>>>16,m+=y>>>16,_+=m>>>16,N=m&65535|_<<16,L=w&65535|y<<16,p=j,g=D,w=g&65535,y=g>>>16,m=p&65535,_=p>>>16,p=R,g=P,w+=g&65535,y+=g>>>16,m+=p&65535,_+=p>>>16,y+=w>>>16,m+=y>>>16,_+=m>>>16,j=m&65535|_<<16,D=w&65535|y<<16,Y=u,H=b,G=S,l=j,J=T,te=ee,ne=U,W=N,V=K,Q=$,ce=F,ie=D,oe=q,se=O,ae=A,z=L,k%16===15)for(E=0;E<16;E++)p=a[E],g=d[E],w=g&65535,y=g>>>16,m=p&65535,_=p>>>16,p=a[(E+9)%16],g=d[(E+9)%16],w+=g&65535,y+=g>>>16,m+=p&65535,_+=p>>>16,R=a[(E+1)%16],P=d[(E+1)%16],p=(R>>>1|P<<31)^(R>>>8|P<<24)^R>>>7,g=(P>>>1|R<<31)^(P>>>8|R<<24)^(P>>>7|R<<25),w+=g&65535,y+=g>>>16,m+=p&65535,_+=p>>>16,R=a[(E+14)%16],P=d[(E+14)%16],p=(R>>>19|P<<13)^(P>>>29|R<<3)^R>>>6,g=(P>>>19|R<<13)^(R>>>29|P<<3)^(P>>>6|R<<26),w+=g&65535,y+=g>>>16,m+=p&65535,_+=p>>>16,y+=w>>>16,m+=y>>>16,_+=m>>>16,a[E]=m&65535|_<<16,d[E]=w&65535|y<<16;p=W,g=z,w=g&65535,y=g>>>16,m=p&65535,_=p>>>16,p=r[0],g=s[0],w+=g&65535,y+=g>>>16,m+=p&65535,_+=p>>>16,y+=w>>>16,m+=y>>>16,_+=m>>>16,r[0]=W=m&65535|_<<16,s[0]=z=w&65535|y<<16,p=Y,g=V,w=g&65535,y=g>>>16,m=p&65535,_=p>>>16,p=r[1],g=s[1],w+=g&65535,y+=g>>>16,m+=p&65535,_+=p>>>16,y+=w>>>16,m+=y>>>16,_+=m>>>16,r[1]=Y=m&65535|_<<16,s[1]=V=w&65535|y<<16,p=H,g=Q,w=g&65535,y=g>>>16,m=p&65535,_=p>>>16,p=r[2],g=s[2],w+=g&65535,y+=g>>>16,m+=p&65535,_+=p>>>16,y+=w>>>16,m+=y>>>16,_+=m>>>16,r[2]=H=m&65535|_<<16,s[2]=Q=w&65535|y<<16,p=G,g=ce,w=g&65535,y=g>>>16,m=p&65535,_=p>>>16,p=r[3],g=s[3],w+=g&65535,y+=g>>>16,m+=p&65535,_+=p>>>16,y+=w>>>16,m+=y>>>16,_+=m>>>16,r[3]=G=m&65535|_<<16,s[3]=ce=w&65535|y<<16,p=l,g=ie,w=g&65535,y=g>>>16,m=p&65535,_=p>>>16,p=r[4],g=s[4],w+=g&65535,y+=g>>>16,m+=p&65535,_+=p>>>16,y+=w>>>16,m+=y>>>16,_+=m>>>16,r[4]=l=m&65535|_<<16,s[4]=ie=w&65535|y<<16,p=J,g=oe,w=g&65535,y=g>>>16,m=p&65535,_=p>>>16,p=r[5],g=s[5],w+=g&65535,y+=g>>>16,m+=p&65535,_+=p>>>16,y+=w>>>16,m+=y>>>16,_+=m>>>16,r[5]=J=m&65535|_<<16,s[5]=oe=w&65535|y<<16,p=te,g=se,w=g&65535,y=g>>>16,m=p&65535,_=p>>>16,p=r[6],g=s[6],w+=g&65535,y+=g>>>16,m+=p&65535,_+=p>>>16,y+=w>>>16,m+=y>>>16,_+=m>>>16,r[6]=te=m&65535|_<<16,s[6]=se=w&65535|y<<16,p=ne,g=ae,w=g&65535,y=g>>>16,m=p&65535,_=p>>>16,p=r[7],g=s[7],w+=g&65535,y+=g>>>16,m+=p&65535,_+=p>>>16,y+=w>>>16,m+=y>>>16,_+=m>>>16,r[7]=ne=m&65535|_<<16,s[7]=ae=w&65535|y<<16,fe+=128,t-=128}return t}function Me(r,s,o){var t=new Int32Array(8),a=new Int32Array(8),d=new Uint8Array(256),u,b=o;for(t[0]=1779033703,t[1]=3144134277,t[2]=1013904242,t[3]=2773480762,t[4]=1359893119,t[5]=2600822924,t[6]=528734635,t[7]=1541459225,a[0]=4089235720,a[1]=2227873595,a[2]=4271175723,a[3]=1595750129,a[4]=2917565137,a[5]=725511199,a[6]=4215389547,a[7]=327033209,En(t,a,s,o),o%=128,u=0;u<o;u++)d[u]=s[b-o+u];for(d[o]=128,o=256-128*(o<112?1:0),d[o-9]=0,ve(d,o-8,b/536870912|0,b<<3),En(t,a,d,o),u=0;u<8;u++)ve(r,8*u,t[u],a[u]);return 0}function ut(r,s){var o=n(),t=n(),a=n(),d=n(),u=n(),b=n(),S=n(),j=n(),T=n();Ee(o,r[1],r[0]),Ee(T,s[1],s[0]),Z(o,o,T),Se(t,r[0],r[1]),Se(T,s[0],s[1]),Z(t,t,T),Z(a,r[3],s[3]),Z(a,a,re),Z(d,r[2],s[2]),Se(d,d,d),Ee(u,t,o),Ee(b,d,a),Se(S,d,a),Se(j,t,o),Z(r[0],u,b),Z(r[1],j,S),Z(r[2],S,b),Z(r[3],u,j)}function Tn(r,s,o){var t;for(t=0;t<4;t++)Ne(r[t],s[t],o)}function Kt(r,s){var o=n(),t=n(),a=n();bn(a,s[2]),Z(o,s[0],a),Z(t,s[1],a),Ke(r,t),r[31]^=yn(o)<<7}function Dt(r,s,o){var t,a;for(Re(r[0],x),Re(r[1],v),Re(r[2],v),Re(r[3],x),a=255;a>=0;--a)t=o[a/8|0]>>(a&7)&1,Tn(r,s,t),ut(s,r),ut(r,r),Tn(r,s,t)}function ht(r,s){var o=[n(),n(),n(),n()];Re(o[0],X),Re(o[1],de),Re(o[2],v),Z(o[3],X,de),Dt(r,o,s)}function Ot(r,s,o){var t=new Uint8Array(64),a=[n(),n(),n(),n()],d;for(o||c(s,32),Me(t,s,32),t[0]&=248,t[31]&=127,t[31]|=64,ht(a,t),Kt(r,a),d=0;d<32;d++)s[d+32]=r[d];return 0}var pt=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function qt(r,s){var o,t,a,d;for(t=63;t>=32;--t){for(o=0,a=t-32,d=t-12;a<d;++a)s[a]+=o-16*s[t]*pt[a-(t-32)],o=Math.floor((s[a]+128)/256),s[a]-=o*256;s[a]+=o,s[t]=0}for(o=0,a=0;a<32;a++)s[a]+=o-(s[31]>>4)*pt[a],o=s[a]>>8,s[a]&=255;for(a=0;a<32;a++)s[a]-=o*pt[a];for(t=0;t<32;t++)s[t+1]+=s[t]>>8,r[t]=s[t]&255}function Ft(r){var s=new Float64Array(64),o;for(o=0;o<64;o++)s[o]=r[o];for(o=0;o<64;o++)r[o]=0;qt(r,s)}function Cn(r,s,o,t){var a=new Uint8Array(64),d=new Uint8Array(64),u=new Uint8Array(64),b,S,j=new Float64Array(64),T=[n(),n(),n(),n()];Me(a,t,32),a[0]&=248,a[31]&=127,a[31]|=64;var ee=o+64;for(b=0;b<o;b++)r[64+b]=s[b];for(b=0;b<32;b++)r[32+b]=a[32+b];for(Me(u,r.subarray(32),o+32),Ft(u),ht(T,u),Kt(r,T),b=32;b<64;b++)r[b]=t[b];for(Me(d,r,o+64),Ft(d),b=0;b<64;b++)j[b]=0;for(b=0;b<32;b++)j[b]=u[b];for(b=0;b<32;b++)for(S=0;S<32;S++)j[b+S]+=d[b]*a[S];return qt(r.subarray(32),j),ee}function Vn(r,s){var o=n(),t=n(),a=n(),d=n(),u=n(),b=n(),S=n();return Re(r[2],v),Nt(r[1],s),me(a,r[1]),Z(d,a,B),Ee(a,a,r[2]),Se(d,r[2],d),me(u,d),me(b,u),Z(S,b,u),Z(o,S,a),Z(o,o,d),mn(o,o),Z(o,o,a),Z(o,o,d),Z(o,o,d),Z(r[0],o,d),me(t,r[0]),Z(t,t,d),vn(t,a)&&Z(r[0],r[0],xe),me(t,r[0]),Z(t,t,d),vn(t,a)?-1:(yn(r[0])===s[31]>>7&&Ee(r[0],x,r[0]),Z(r[3],r[0],r[1]),0)}function $t(r,s,o,t){var a,d=new Uint8Array(32),u=new Uint8Array(64),b=[n(),n(),n(),n()],S=[n(),n(),n(),n()];if(o<64||Vn(S,t))return-1;for(a=0;a<o;a++)r[a]=s[a];for(a=0;a<32;a++)r[a+32]=t[a];if(Me(u,r,o),Ft(u),Dt(b,S,u),ht(S,s.subarray(32)),ut(b,S),Kt(d,b),o-=64,Ge(s,0,d,0)){for(a=0;a<o;a++)r[a]=0;return-1}for(a=0;a<o;a++)r[a]=s[a+64];return o}var Yt=32,gt=24,He=32,De=16,ze=32,xt=32,Je=32,Xe=32,Gt=32,Rn=gt,Qn=He,er=De,Ue=64,We=32,Oe=64,Ht=32,zt=64;e.lowlevel={crypto_core_hsalsa20:at,crypto_stream_xor:It,crypto_stream:gn,crypto_stream_salsa20_xor:hn,crypto_stream_salsa20:pn,crypto_onetimeauth:Lt,crypto_onetimeauth_verify:xn,crypto_verify_16:ot,crypto_verify_32:Ge,crypto_secretbox:Mt,crypto_secretbox_open:Wt,crypto_scalarmult:ft,crypto_scalarmult_base:lt,crypto_box_beforenm:dt,crypto_box_afternm:_n,crypto_box:Xn,crypto_box_open:Zn,crypto_box_keypair:wn,crypto_hash:Me,crypto_sign:Cn,crypto_sign_keypair:Ot,crypto_sign_open:$t,crypto_secretbox_KEYBYTES:Yt,crypto_secretbox_NONCEBYTES:gt,crypto_secretbox_ZEROBYTES:He,crypto_secretbox_BOXZEROBYTES:De,crypto_scalarmult_BYTES:ze,crypto_scalarmult_SCALARBYTES:xt,crypto_box_PUBLICKEYBYTES:Je,crypto_box_SECRETKEYBYTES:Xe,crypto_box_BEFORENMBYTES:Gt,crypto_box_NONCEBYTES:Rn,crypto_box_ZEROBYTES:Qn,crypto_box_BOXZEROBYTES:er,crypto_sign_BYTES:Ue,crypto_sign_PUBLICKEYBYTES:We,crypto_sign_SECRETKEYBYTES:Oe,crypto_sign_SEEDBYTES:Ht,crypto_hash_BYTES:zt,gf:n,D:B,L:pt,pack25519:Ke,unpack25519:Nt,M:Z,A:Se,S:me,Z:Ee,pow2523:mn,add:ut,set25519:Re,modL:qt,scalarmult:Dt,scalarbase:ht};function Un(r,s){if(r.length!==Yt)throw new Error("bad key size");if(s.length!==gt)throw new Error("bad nonce size")}function tr(r,s){if(r.length!==Je)throw new Error("bad public key size");if(s.length!==Xe)throw new Error("bad secret key size")}function ye(){for(var r=0;r<arguments.length;r++)if(!(arguments[r]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function An(r){for(var s=0;s<r.length;s++)r[s]=0}e.randomBytes=function(r){var s=new Uint8Array(r);return c(s,r),s},e.secretbox=function(r,s,o){ye(r,s,o),Un(o,s);for(var t=new Uint8Array(He+r.length),a=new Uint8Array(t.length),d=0;d<r.length;d++)t[d+He]=r[d];return Mt(a,t,t.length,s,o),a.subarray(De)},e.secretbox.open=function(r,s,o){ye(r,s,o),Un(o,s);for(var t=new Uint8Array(De+r.length),a=new Uint8Array(t.length),d=0;d<r.length;d++)t[d+De]=r[d];return t.length<32||Wt(a,t,t.length,s,o)!==0?null:a.subarray(He)},e.secretbox.keyLength=Yt,e.secretbox.nonceLength=gt,e.secretbox.overheadLength=De,e.scalarMult=function(r,s){if(ye(r,s),r.length!==xt)throw new Error("bad n size");if(s.length!==ze)throw new Error("bad p size");var o=new Uint8Array(ze);return ft(o,r,s),o},e.scalarMult.base=function(r){if(ye(r),r.length!==xt)throw new Error("bad n size");var s=new Uint8Array(ze);return lt(s,r),s},e.scalarMult.scalarLength=xt,e.scalarMult.groupElementLength=ze,e.box=function(r,s,o,t){var a=e.box.before(o,t);return e.secretbox(r,s,a)},e.box.before=function(r,s){ye(r,s),tr(r,s);var o=new Uint8Array(Gt);return dt(o,r,s),o},e.box.after=e.secretbox,e.box.open=function(r,s,o,t){var a=e.box.before(o,t);return e.secretbox.open(r,s,a)},e.box.open.after=e.secretbox.open,e.box.keyPair=function(){var r=new Uint8Array(Je),s=new Uint8Array(Xe);return wn(r,s),{publicKey:r,secretKey:s}},e.box.keyPair.fromSecretKey=function(r){if(ye(r),r.length!==Xe)throw new Error("bad secret key size");var s=new Uint8Array(Je);return lt(s,r),{publicKey:s,secretKey:new Uint8Array(r)}},e.box.publicKeyLength=Je,e.box.secretKeyLength=Xe,e.box.sharedKeyLength=Gt,e.box.nonceLength=Rn,e.box.overheadLength=e.secretbox.overheadLength,e.sign=function(r,s){if(ye(r,s),s.length!==Oe)throw new Error("bad secret key size");var o=new Uint8Array(Ue+r.length);return Cn(o,r,r.length,s),o},e.sign.open=function(r,s){if(ye(r,s),s.length!==We)throw new Error("bad public key size");var o=new Uint8Array(r.length),t=$t(o,r,r.length,s);if(t<0)return null;for(var a=new Uint8Array(t),d=0;d<a.length;d++)a[d]=o[d];return a},e.sign.detached=function(r,s){for(var o=e.sign(r,s),t=new Uint8Array(Ue),a=0;a<t.length;a++)t[a]=o[a];return t},e.sign.detached.verify=function(r,s,o){if(ye(r,s,o),s.length!==Ue)throw new Error("bad signature size");if(o.length!==We)throw new Error("bad public key size");var t=new Uint8Array(Ue+r.length),a=new Uint8Array(Ue+r.length),d;for(d=0;d<Ue;d++)t[d]=s[d];for(d=0;d<r.length;d++)t[d+Ue]=r[d];return $t(a,t,t.length,o)>=0},e.sign.keyPair=function(){var r=new Uint8Array(We),s=new Uint8Array(Oe);return Ot(r,s),{publicKey:r,secretKey:s}},e.sign.keyPair.fromSecretKey=function(r){if(ye(r),r.length!==Oe)throw new Error("bad secret key size");for(var s=new Uint8Array(We),o=0;o<s.length;o++)s[o]=r[32+o];return{publicKey:s,secretKey:new Uint8Array(r)}},e.sign.keyPair.fromSeed=function(r){if(ye(r),r.length!==Ht)throw new Error("bad seed size");for(var s=new Uint8Array(We),o=new Uint8Array(Oe),t=0;t<32;t++)o[t]=r[t];return Ot(s,o,!0),{publicKey:s,secretKey:o}},e.sign.publicKeyLength=We,e.sign.secretKeyLength=Oe,e.sign.seedLength=Ht,e.sign.signatureLength=Ue,e.hash=function(r){ye(r);var s=new Uint8Array(zt);return Me(s,r,r.length),s},e.hash.hashLength=zt,e.verify=function(r,s){return ye(r,s),r.length===0||s.length===0||r.length!==s.length?!1:_e(r,0,s,0,r.length)===0},e.setPRNG=function(r){c=r},function(){var r=typeof self<"u"?self.crypto||self.msCrypto:null;if(r&&r.getRandomValues){var s=65536;e.setPRNG(function(o,t){var a,d=new Uint8Array(t);for(a=0;a<t;a+=s)r.getRandomValues(d.subarray(a,a+Math.min(t-a,s)));for(a=0;a<t;a++)o[a]=d[a];An(d)})}else typeof nr<"u"&&(r=rr,r&&r.randomBytes&&e.setPRNG(function(o,t){var a,d=r.randomBytes(t);for(a=0;a<t;a++)o[a]=d[a];An(d)}))}()})(i.exports?i.exports:self.nacl=self.nacl||{})}(Jt)),Jt.exports}var cr=ar();const vt=On(cr);var je;(function(i){i[i.UNKNOWN_ERROR=0]="UNKNOWN_ERROR",i[i.BAD_REQUEST_ERROR=1]="BAD_REQUEST_ERROR",i[i.MANIFEST_NOT_FOUND_ERROR=2]="MANIFEST_NOT_FOUND_ERROR",i[i.MANIFEST_CONTENT_ERROR=3]="MANIFEST_CONTENT_ERROR",i[i.UNKNOWN_APP_ERROR=100]="UNKNOWN_APP_ERROR",i[i.USER_REJECTS_ERROR=300]="USER_REJECTS_ERROR",i[i.METHOD_NOT_SUPPORTED=400]="METHOD_NOT_SUPPORTED"})(je||(je={}));var _t;(function(i){i[i.UNKNOWN_ERROR=0]="UNKNOWN_ERROR",i[i.METHOD_NOT_SUPPORTED=400]="METHOD_NOT_SUPPORTED"})(_t||(_t={}));var qe;(function(i){i[i.UNKNOWN_ERROR=0]="UNKNOWN_ERROR",i[i.BAD_REQUEST_ERROR=1]="BAD_REQUEST_ERROR",i[i.UNKNOWN_APP_ERROR=100]="UNKNOWN_APP_ERROR",i[i.USER_REJECTS_ERROR=300]="USER_REJECTS_ERROR",i[i.METHOD_NOT_SUPPORTED=400]="METHOD_NOT_SUPPORTED"})(qe||(qe={}));var Fe;(function(i){i[i.UNKNOWN_ERROR=0]="UNKNOWN_ERROR",i[i.BAD_REQUEST_ERROR=1]="BAD_REQUEST_ERROR",i[i.UNKNOWN_APP_ERROR=100]="UNKNOWN_APP_ERROR",i[i.USER_REJECTS_ERROR=300]="USER_REJECTS_ERROR",i[i.METHOD_NOT_SUPPORTED=400]="METHOD_NOT_SUPPORTED"})(Fe||(Fe={}));var jn;(function(i){i[i.UNKNOWN_ERROR=0]="UNKNOWN_ERROR",i[i.BAD_REQUEST_ERROR=1]="BAD_REQUEST_ERROR",i[i.UNKNOWN_APP_ERROR=100]="UNKNOWN_APP_ERROR",i[i.METHOD_NOT_SUPPORTED=400]="METHOD_NOT_SUPPORTED"})(jn||(jn={}));var In;(function(i){i.MAINNET="-239",i.TESTNET="-3"})(In||(In={}));function fr(i,e){const n=Qe.encodeBase64(i);return e?encodeURIComponent(n):n}function lr(i,e){return e&&(i=decodeURIComponent(i)),Qe.decodeBase64(i)}function dr(i,e=!1){let n;return i instanceof Uint8Array?n=i:(typeof i!="string"&&(i=JSON.stringify(i)),n=Qe.decodeUTF8(i)),fr(n,e)}function ur(i,e=!1){const n=lr(i,e);return{toString(){return Qe.encodeUTF8(n)},toObject(){try{return JSON.parse(Qe.encodeUTF8(n))}catch{return null}},toUint8Array(){return n}}}const on={encode:dr,decode:ur};function hr(i,e){const n=new Uint8Array(i.length+e.length);return n.set(i),n.set(e,i.length),n}function pr(i,e){if(e>=i.length)throw new Error("Index is out of buffer");const n=i.slice(0,e),c=i.slice(e);return[n,c]}function Xt(i){let e="";return i.forEach(n=>{e+=("0"+(n&255).toString(16)).slice(-2)}),e}function St(i){if(i.length%2!==0)throw new Error(`Cannot convert ${i} to bytesArray`);const e=new Uint8Array(i.length/2);for(let n=0;n<i.length;n+=2)e[n/2]=parseInt(i.slice(n,n+2),16);return e}class Qt{constructor(e){this.nonceLength=24,this.keyPair=e?this.createKeypairFromString(e):this.createKeypair(),this.sessionId=Xt(this.keyPair.publicKey)}createKeypair(){return vt.box.keyPair()}createKeypairFromString(e){return{publicKey:St(e.publicKey),secretKey:St(e.secretKey)}}createNonce(){return vt.randomBytes(this.nonceLength)}encrypt(e,n){const c=new TextEncoder().encode(e),f=this.createNonce(),h=vt.box(c,f,n,this.keyPair.secretKey);return hr(f,h)}decrypt(e,n){const[c,f]=pr(e,this.nonceLength),h=vt.box.open(f,c,n,this.keyPair.secretKey);if(!h)throw new Error(`Decryption error: 
 message: ${e.toString()} 
 sender pubkey: ${n.toString()} 
 keypair pubkey: ${this.keyPair.publicKey.toString()} 
 keypair secretkey: ${this.keyPair.secretKey.toString()}`);return new TextDecoder().decode(h)}stringifyKeypair(){return{publicKey:Xt(this.keyPair.publicKey),secretKey:Xt(this.keyPair.secretKey)}}}function Ln(i,e){var n={};for(var c in i)Object.prototype.hasOwnProperty.call(i,c)&&e.indexOf(c)<0&&(n[c]=i[c]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var f=0,c=Object.getOwnPropertySymbols(i);f<c.length;f++)e.indexOf(c[f])<0&&Object.prototype.propertyIsEnumerable.call(i,c[f])&&(n[c[f]]=i[c[f]]);return n}function C(i,e,n,c){function f(h){return h instanceof n?h:new n(function(x){x(h)})}return new(n||(n=Promise))(function(h,x){function v(re){try{B(c.next(re))}catch(X){x(X)}}function M(re){try{B(c.throw(re))}catch(X){x(X)}}function B(re){re.done?h(re.value):f(re.value).then(v,M)}B((c=c.apply(i,[])).next())})}class I extends Error{get info(){return""}constructor(e,n){super(e,n),this.message=`${I.prefix} ${this.constructor.name}${this.info?": "+this.info:""}${e?`
`+e:""}`,Object.setPrototypeOf(this,I.prototype)}}I.prefix="[TON_CONNECT_SDK_ERROR]";class sn extends I{get info(){return"Passed DappMetadata is in incorrect format."}constructor(...e){super(...e),Object.setPrototypeOf(this,sn.prototype)}}class Ct extends I{get info(){return"Passed `tonconnect-manifest.json` contains errors. Check format of your manifest. See more https://github.com/ton-connect/docs/blob/main/requests-responses.md#app-manifest"}constructor(...e){super(...e),Object.setPrototypeOf(this,Ct.prototype)}}class Rt extends I{get info(){return"Manifest not found. Make sure you added `tonconnect-manifest.json` to the root of your app or passed correct manifestUrl. See more https://github.com/ton-connect/docs/blob/main/requests-responses.md#app-manifest"}constructor(...e){super(...e),Object.setPrototypeOf(this,Rt.prototype)}}class an extends I{get info(){return"Wallet connection called but wallet already connected. To avoid the error, disconnect the wallet before doing a new connection."}constructor(...e){super(...e),Object.setPrototypeOf(this,an.prototype)}}class Et extends I{get info(){return"Send transaction or other protocol methods called while wallet is not connected."}constructor(...e){super(...e),Object.setPrototypeOf(this,Et.prototype)}}class cn extends I{get info(){return"There is an attempt to connect to the injected wallet while it is not exists in the webpage."}constructor(...e){super(...e),Object.setPrototypeOf(this,cn.prototype)}}class Be extends I{get info(){return"Wallet doesn't support requested feature method."}constructor(e,n){super(e,n),Object.setPrototypeOf(this,Be.prototype)}}class fn extends I{get info(){return"Missing required features. You need to update your wallet."}constructor(e,n){super(e,n),Object.setPrototypeOf(this,fn.prototype)}}function gr(i){return"jsBridgeKey"in i}class nt extends I{get info(){return"User rejects the action in the wallet."}constructor(...e){super(...e),Object.setPrototypeOf(this,nt.prototype)}}class rt extends I{get info(){return"Request to the wallet contains errors."}constructor(...e){super(...e),Object.setPrototypeOf(this,rt.prototype)}}class it extends I{get info(){return"App tries to send rpc request to the injected wallet while not connected."}constructor(...e){super(...e),Object.setPrototypeOf(this,it.prototype)}}class ln extends I{get info(){return"An error occurred while fetching the wallets list."}constructor(...e){super(...e),Object.setPrototypeOf(this,ln.prototype)}}class Te extends I{get info(){return"Passed address is in incorrect format."}constructor(...e){super(...e),Object.setPrototypeOf(this,Te.prototype)}}class Tt extends I{get info(){return"Passed hex is in incorrect format."}constructor(...e){super(...e),Object.setPrototypeOf(this,Tt.prototype)}}class Ce extends I{constructor(...e){super(...e),Object.setPrototypeOf(this,Ce.prototype)}}const Mn={[je.UNKNOWN_ERROR]:Ce,[je.USER_REJECTS_ERROR]:nt,[je.BAD_REQUEST_ERROR]:rt,[je.UNKNOWN_APP_ERROR]:it,[je.MANIFEST_NOT_FOUND_ERROR]:Rt,[je.MANIFEST_CONTENT_ERROR]:Ct};class xr{parseError(e){let n=Ce;return e.code in Mn&&(n=Mn[e.code]||Ce),new n(e.message)}}const vr=new xr;class qn{isError(e){return"error"in e}}const Wn={[qe.UNKNOWN_ERROR]:Ce,[qe.USER_REJECTS_ERROR]:nt,[qe.BAD_REQUEST_ERROR]:rt,[qe.UNKNOWN_APP_ERROR]:it};class yr extends qn{convertToRpcRequest(e){return{method:"sendTransaction",params:[JSON.stringify(e)]}}parseAndThrowError(e){let n=Ce;throw e.error.code in Wn&&(n=Wn[e.error.code]||Ce),new n(e.error.message)}convertFromRpcResponse(e){return{boc:e.result}}}const yt=new yr,Bn={[Fe.UNKNOWN_ERROR]:Ce,[Fe.USER_REJECTS_ERROR]:nt,[Fe.BAD_REQUEST_ERROR]:rt,[Fe.UNKNOWN_APP_ERROR]:it};class br extends qn{convertToRpcRequest(e){return{method:"signData",params:[JSON.stringify(e)]}}parseAndThrowError(e){let n=Ce;throw e.error.code in Bn&&(n=Bn[e.error.code]||Ce),new n(e.error.message)}convertFromRpcResponse(e){return e.result}}const bt=new br;class mr{constructor(e,n){this.storage=e,this.storeKey="ton-connect-storage_http-bridge-gateway::"+n}storeLastEventId(e){return C(this,void 0,void 0,function*(){return this.storage.setItem(this.storeKey,e)})}removeLastEventId(){return C(this,void 0,void 0,function*(){return this.storage.removeItem(this.storeKey)})}getLastEventId(){return C(this,void 0,void 0,function*(){const e=yield this.storage.getItem(this.storeKey);return e||null})}}function wr(i){return i.slice(-1)==="/"?i.slice(0,-1):i}function Fn(i,e){return wr(i)+"/"+e}function _r(i){if(!i)return!1;const e=new URL(i);return e.protocol==="tg:"||e.hostname==="t.me"}function Sr(i){return i.replaceAll(".","%2E").replaceAll("-","%2D").replaceAll("_","%5F").replaceAll("&","-").replaceAll("=","__").replaceAll("%","--")}function $n(i,e){return C(this,void 0,void 0,function*(){return new Promise((n,c)=>{var f,h;if(!((f=void 0)===null||f===void 0)&&f.aborted){c(new I("Delay aborted"));return}const x=setTimeout(()=>n(),i);(h=void 0)===null||h===void 0||h.addEventListener("abort",()=>{clearTimeout(x),c(new I("Delay aborted"))})})})}function we(i){const e=new AbortController;return i?.aborted?e.abort():i?.addEventListener("abort",()=>e.abort(),{once:!0}),e}function Ze(i,e){return C(this,void 0,void 0,function*(){var n,c;const f=(n=e?.attempts)!==null&&n!==void 0?n:10,h=(c=e?.delayMs)!==null&&c!==void 0?c:200,x=we(e?.signal);if(typeof i!="function")throw new I(`Expected a function, got ${typeof i}`);let v=0,M;for(;v<f;){if(x.signal.aborted)throw new I(`Aborted after attempts ${v}`);try{return yield i({signal:x.signal})}catch(B){M=B,v++,v<f&&(yield $n(h))}}throw M})}function le(...i){try{console.debug("[TON_CONNECT_SDK]",...i)}catch{}}function Ie(...i){try{console.error("[TON_CONNECT_SDK]",...i)}catch{}}function Er(...i){try{console.warn("[TON_CONNECT_SDK]",...i)}catch{}}function Tr(i,e){let n=null,c=null,f=null,h=null,x=null;const v=(X,...de)=>C(this,void 0,void 0,function*(){if(h=X??null,x?.abort(),x=we(X),x.signal.aborted)throw new I("Resource creation was aborted");c=de??null;const xe=i(x.signal,...de);f=xe;const ve=yield xe;if(f!==xe&&ve!==n)throw yield e(ve),new I("Resource creation was aborted by a new resource creation");return n=ve,n});return{create:v,current:()=>n??null,dispose:()=>C(this,void 0,void 0,function*(){try{const X=n;n=null;const de=f;f=null;try{x?.abort()}catch{}yield Promise.allSettled([X?e(X):Promise.resolve(),de?e(yield de):Promise.resolve()])}catch{}}),recreate:X=>C(this,void 0,void 0,function*(){const de=n,xe=f,ve=c,_e=h;if(yield $n(X),de===n&&xe===f&&ve===c&&_e===h)return yield v(h,...ve??[]);throw new I("Resource recreation was aborted by a new resource creation")})}}function Cr(i,e){const n=e?.timeout,c=e?.signal,f=we(c);return new Promise((h,x)=>C(this,void 0,void 0,function*(){if(f.signal.aborted){x(new I("Operation aborted"));return}let v;typeof n<"u"&&(v=setTimeout(()=>{f.abort(),x(new I(`Timeout after ${n}ms`))},n)),f.signal.addEventListener("abort",()=>{clearTimeout(v),x(new I("Operation aborted"))},{once:!0});const M={timeout:n,abort:f.signal};yield i((...B)=>{clearTimeout(v),h(...B)},()=>{clearTimeout(v),x()},M)}))}class Zt{get isReady(){const e=this.eventSource.current();return e?.readyState===EventSource.OPEN}get isClosed(){const e=this.eventSource.current();return e?.readyState!==EventSource.OPEN}get isConnecting(){const e=this.eventSource.current();return e?.readyState===EventSource.CONNECTING}constructor(e,n,c,f,h){this.bridgeUrl=n,this.sessionId=c,this.listener=f,this.errorsListener=h,this.ssePath="events",this.postPath="message",this.heartbeatMessage="heartbeat",this.defaultTtl=300,this.defaultReconnectDelay=2e3,this.defaultResendDelay=5e3,this.eventSource=Tr((x,v)=>C(this,void 0,void 0,function*(){const M={bridgeUrl:this.bridgeUrl,ssePath:this.ssePath,sessionId:this.sessionId,bridgeGatewayStorage:this.bridgeGatewayStorage,errorHandler:this.errorsHandler.bind(this),messageHandler:this.messagesHandler.bind(this),signal:x,openingDeadlineMS:v};return yield Rr(M)}),x=>C(this,void 0,void 0,function*(){x.close()})),this.bridgeGatewayStorage=new mr(e,n)}registerSession(e){return C(this,void 0,void 0,function*(){yield this.eventSource.create(e?.signal,e?.openingDeadlineMS)})}send(e,n,c,f){return C(this,void 0,void 0,function*(){var h;const x={};typeof f=="number"?x.ttl=f:(x.ttl=f?.ttl,x.signal=f?.signal,x.attempts=f?.attempts);const v=new URL(Fn(this.bridgeUrl,this.postPath));v.searchParams.append("client_id",this.sessionId),v.searchParams.append("to",n),v.searchParams.append("ttl",(x?.ttl||this.defaultTtl).toString()),v.searchParams.append("topic",c);const M=on.encode(e);yield Ze(B=>C(this,void 0,void 0,function*(){const re=yield this.post(v,M,B.signal);if(!re.ok)throw new I(`Bridge send failed, status ${re.status}`)}),{attempts:(h=x?.attempts)!==null&&h!==void 0?h:Number.MAX_SAFE_INTEGER,delayMs:this.defaultResendDelay,signal:x?.signal})})}pause(){this.eventSource.dispose().catch(e=>Ie(`Bridge pause failed, ${e}`))}unPause(){return C(this,void 0,void 0,function*(){yield this.eventSource.recreate(0)})}close(){return C(this,void 0,void 0,function*(){yield this.eventSource.dispose().catch(e=>Ie(`Bridge close failed, ${e}`))})}setListener(e){this.listener=e}setErrorsListener(e){this.errorsListener=e}post(e,n,c){return C(this,void 0,void 0,function*(){const f=yield fetch(e,{method:"post",body:n,signal:c});if(!f.ok)throw new I(`Bridge send failed, status ${f.status}`);return f})}errorsHandler(e,n){return C(this,void 0,void 0,function*(){if(this.isConnecting)throw e.close(),new I("Bridge error, failed to connect");if(this.isReady){try{this.errorsListener(n)}catch{}return}if(this.isClosed)return e.close(),le(`Bridge reconnecting, ${this.defaultReconnectDelay}ms delay`),yield this.eventSource.recreate(this.defaultReconnectDelay);throw new I("Bridge error, unknown state")})}messagesHandler(e){return C(this,void 0,void 0,function*(){if(e.data===this.heartbeatMessage||(yield this.bridgeGatewayStorage.storeLastEventId(e.lastEventId),this.isClosed))return;let n;try{n=JSON.parse(e.data)}catch{throw new I(`Bridge message parse failed, message ${e.data}`)}this.listener(n)})}}function Rr(i){return C(this,void 0,void 0,function*(){return yield Cr((e,n,c)=>C(this,void 0,void 0,function*(){var f;const x=we(c.signal).signal;if(x.aborted){n(new I("Bridge connection aborted"));return}const v=new URL(Fn(i.bridgeUrl,i.ssePath));v.searchParams.append("client_id",i.sessionId);const M=yield i.bridgeGatewayStorage.getLastEventId();if(M&&v.searchParams.append("last_event_id",M),x.aborted){n(new I("Bridge connection aborted"));return}const B=new EventSource(v.toString());B.onerror=re=>C(this,void 0,void 0,function*(){if(x.aborted){B.close(),n(new I("Bridge connection aborted"));return}try{const X=yield i.errorHandler(B,re);X!==B&&B.close(),X&&X!==B&&e(X)}catch(X){B.close(),n(X)}}),B.onopen=()=>{if(x.aborted){B.close(),n(new I("Bridge connection aborted"));return}e(B)},B.onmessage=re=>{if(x.aborted){B.close(),n(new I("Bridge connection aborted"));return}i.messageHandler(re)},(f=i.signal)===null||f===void 0||f.addEventListener("abort",()=>{B.close(),n(new I("Bridge connection aborted"))})}),{timeout:i.openingDeadlineMS,signal:i.signal})})}const Ur=5*60*1e3;function Ve(i){return!("connectEvent"in i)}function Ar(i){return!("connectEvent"in i)}function Pr(i){var e;return Date.now()-((e=i.createdAt)!==null&&e!==void 0?e:0)>Ur}class et{constructor(e){this.storage=e,this.storeKey="ton-connect-storage_bridge-connection"}storeConnection(e){return C(this,void 0,void 0,function*(){if(e.type==="injected")return this.storage.setItem(this.storeKey,JSON.stringify(e));if(!Ve(e)){const c={sessionKeyPair:e.session.sessionCrypto.stringifyKeypair(),walletPublicKey:e.session.walletPublicKey,bridgeUrl:e.session.bridgeUrl},f={type:"http",connectEvent:e.connectEvent,session:c,lastWalletEventId:e.lastWalletEventId,nextRpcRequestId:e.nextRpcRequestId};return this.storage.setItem(this.storeKey,JSON.stringify(f))}const n={type:"http",connectionSource:e.connectionSource,sessionCrypto:e.sessionCrypto.stringifyKeypair(),createdAt:Date.now()};return this.storage.setItem(this.storeKey,JSON.stringify(n))})}removeConnection(){return C(this,void 0,void 0,function*(){return this.storage.removeItem(this.storeKey)})}getConnection(){return C(this,void 0,void 0,function*(){const e=yield this.storage.getItem(this.storeKey);if(!e)return null;const n=JSON.parse(e);if(n.type==="injected")return n;if(!Ar(n)){const c=new Qt(n.session.sessionKeyPair);return{type:"http",connectEvent:n.connectEvent,lastWalletEventId:n.lastWalletEventId,nextRpcRequestId:n.nextRpcRequestId,session:{sessionCrypto:c,bridgeUrl:n.session.bridgeUrl,walletPublicKey:n.session.walletPublicKey}}}return Pr(n)?(yield this.removeConnection(),null):{type:"http",sessionCrypto:new Qt(n.sessionCrypto),connectionSource:n.connectionSource}})}getHttpConnection(){return C(this,void 0,void 0,function*(){const e=yield this.getConnection();if(!e)throw new I("Trying to read HTTP connection source while nothing is stored");if(e.type==="injected")throw new I("Trying to read HTTP connection source while injected connection is stored");return e})}getHttpPendingConnection(){return C(this,void 0,void 0,function*(){const e=yield this.getConnection();if(!e)throw new I("Trying to read HTTP connection source while nothing is stored");if(e.type==="injected")throw new I("Trying to read HTTP connection source while injected connection is stored");if(!Ve(e))throw new I("Trying to read HTTP-pending connection while http connection is stored");return e})}getInjectedConnection(){return C(this,void 0,void 0,function*(){const e=yield this.getConnection();if(!e)throw new I("Trying to read Injected bridge connection source while nothing is stored");if(e?.type==="http")throw new I("Trying to read Injected bridge connection source while HTTP connection is stored");return e})}storedConnectionType(){return C(this,void 0,void 0,function*(){const e=yield this.storage.getItem(this.storeKey);return e?JSON.parse(e).type:null})}storeLastWalletEventId(e){return C(this,void 0,void 0,function*(){const n=yield this.getConnection();if(n&&n.type==="http"&&!Ve(n))return n.lastWalletEventId=e,this.storeConnection(n)})}getLastWalletEventId(){return C(this,void 0,void 0,function*(){const e=yield this.getConnection();if(e&&"lastWalletEventId"in e)return e.lastWalletEventId})}increaseNextRpcRequestId(){return C(this,void 0,void 0,function*(){const e=yield this.getConnection();if(e&&"nextRpcRequestId"in e){const n=e.nextRpcRequestId||0;return e.nextRpcRequestId=n+1,this.storeConnection(e)}})}getNextRpcRequestId(){return C(this,void 0,void 0,function*(){const e=yield this.getConnection();return e&&"nextRpcRequestId"in e&&e.nextRpcRequestId||0})}}const Yn=2;class tt{static fromStorage(e){return C(this,void 0,void 0,function*(){const c=yield new et(e).getHttpConnection();return Ve(c)?new tt(e,c.connectionSource):new tt(e,{bridgeUrl:c.session.bridgeUrl})})}constructor(e,n){this.storage=e,this.walletConnectionSource=n,this.type="http",this.standardUniversalLink="tc://",this.pendingRequests=new Map,this.session=null,this.gateway=null,this.pendingGateways=[],this.listeners=[],this.defaultOpeningDeadlineMS=12e3,this.defaultRetryTimeoutMS=2e3,this.connectionStorage=new et(e)}connect(e,n){var c;const f=we(n?.signal);(c=this.abortController)===null||c===void 0||c.abort(),this.abortController=f,this.closeGateways();const h=new Qt;this.session={sessionCrypto:h,bridgeUrl:"bridgeUrl"in this.walletConnectionSource?this.walletConnectionSource.bridgeUrl:""},this.connectionStorage.storeConnection({type:"http",connectionSource:this.walletConnectionSource,sessionCrypto:h}).then(()=>C(this,void 0,void 0,function*(){f.signal.aborted||(yield Ze(v=>{var M;return this.openGateways(h,{openingDeadlineMS:(M=n?.openingDeadlineMS)!==null&&M!==void 0?M:this.defaultOpeningDeadlineMS,signal:v?.signal})},{attempts:Number.MAX_SAFE_INTEGER,delayMs:this.defaultRetryTimeoutMS,signal:f.signal}))}));const x="universalLink"in this.walletConnectionSource&&this.walletConnectionSource.universalLink?this.walletConnectionSource.universalLink:this.standardUniversalLink;return this.generateUniversalLink(x,e)}restoreConnection(e){return C(this,void 0,void 0,function*(){var n,c;const f=we(e?.signal);if((n=this.abortController)===null||n===void 0||n.abort(),this.abortController=f,f.signal.aborted)return;this.closeGateways();const h=yield this.connectionStorage.getHttpConnection();if(!h||f.signal.aborted)return;const x=(c=e?.openingDeadlineMS)!==null&&c!==void 0?c:this.defaultOpeningDeadlineMS;if(Ve(h))return this.session={sessionCrypto:h.sessionCrypto,bridgeUrl:"bridgeUrl"in this.walletConnectionSource?this.walletConnectionSource.bridgeUrl:""},yield this.openGateways(h.sessionCrypto,{openingDeadlineMS:x,signal:f?.signal});if(Array.isArray(this.walletConnectionSource))throw new I("Internal error. Connection source is array while WalletConnectionSourceHTTP was expected.");if(this.session=h.session,this.gateway&&(le("Gateway is already opened, closing previous gateway"),yield this.gateway.close()),this.gateway=new Zt(this.storage,this.walletConnectionSource.bridgeUrl,h.session.sessionCrypto.sessionId,this.gatewayListener.bind(this),this.gatewayErrorsListener.bind(this)),!f.signal.aborted){this.listeners.forEach(v=>v(h.connectEvent));try{yield Ze(v=>this.gateway.registerSession({openingDeadlineMS:x,signal:v.signal}),{attempts:Number.MAX_SAFE_INTEGER,delayMs:this.defaultRetryTimeoutMS,signal:f.signal})}catch{yield this.disconnect({signal:f.signal});return}}})}sendRequest(e,n){const c={};return typeof n=="function"?c.onRequestSent=n:(c.onRequestSent=n?.onRequestSent,c.signal=n?.signal,c.attempts=n?.attempts),new Promise((f,h)=>C(this,void 0,void 0,function*(){var x;if(!this.gateway||!this.session||!("walletPublicKey"in this.session))throw new I("Trying to send bridge request without session");const v=(yield this.connectionStorage.getNextRpcRequestId()).toString();yield this.connectionStorage.increaseNextRpcRequestId(),le("Send http-bridge request:",Object.assign(Object.assign({},e),{id:v}));const M=this.session.sessionCrypto.encrypt(JSON.stringify(Object.assign(Object.assign({},e),{id:v})),St(this.session.walletPublicKey));try{yield this.gateway.send(M,this.session.walletPublicKey,e.method,{attempts:c?.attempts,signal:c?.signal}),(x=c?.onRequestSent)===null||x===void 0||x.call(c),this.pendingRequests.set(v.toString(),f)}catch(B){h(B)}}))}closeConnection(){this.closeGateways(),this.listeners=[],this.session=null,this.gateway=null}disconnect(e){return C(this,void 0,void 0,function*(){return new Promise(n=>C(this,void 0,void 0,function*(){let c=!1,f=null;const h=()=>{c||(c=!0,this.removeBridgeAndSession().then(n))};try{this.closeGateways();const x=we(e?.signal);f=setTimeout(()=>{x.abort()},this.defaultOpeningDeadlineMS),yield this.sendRequest({method:"disconnect",params:[]},{onRequestSent:h,signal:x.signal,attempts:1})}catch(x){le("Disconnect error:",x),c||this.removeBridgeAndSession().then(n)}finally{f&&clearTimeout(f),h()}}))})}listen(e){return this.listeners.push(e),()=>this.listeners=this.listeners.filter(n=>n!==e)}pause(){var e;(e=this.gateway)===null||e===void 0||e.pause(),this.pendingGateways.forEach(n=>n.pause())}unPause(){return C(this,void 0,void 0,function*(){const e=this.pendingGateways.map(n=>n.unPause());this.gateway&&e.push(this.gateway.unPause()),yield Promise.all(e)})}pendingGatewaysListener(e,n,c){return C(this,void 0,void 0,function*(){if(!this.pendingGateways.includes(e)){yield e.close();return}return this.closeGateways({except:e}),this.gateway&&(le("Gateway is already opened, closing previous gateway"),yield this.gateway.close()),this.session.bridgeUrl=n,this.gateway=e,this.gateway.setErrorsListener(this.gatewayErrorsListener.bind(this)),this.gateway.setListener(this.gatewayListener.bind(this)),this.gatewayListener(c)})}gatewayListener(e){return C(this,void 0,void 0,function*(){const n=JSON.parse(this.session.sessionCrypto.decrypt(on.decode(e.message).toUint8Array(),St(e.from)));if(le("Wallet message received:",n),!("event"in n)){const f=n.id.toString(),h=this.pendingRequests.get(f);if(!h){le(`Response id ${f} doesn't match any request's id`);return}h(n),this.pendingRequests.delete(f);return}if(n.id!==void 0){const f=yield this.connectionStorage.getLastWalletEventId();if(f!==void 0&&n.id<=f){Ie(`Received event id (=${n.id}) must be greater than stored last wallet event id (=${f}) `);return}n.event!=="connect"&&(yield this.connectionStorage.storeLastWalletEventId(n.id))}const c=this.listeners;n.event==="connect"&&(yield this.updateSession(n,e.from)),n.event==="disconnect"&&(le("Removing bridge and session: received disconnect event"),yield this.removeBridgeAndSession()),c.forEach(f=>f(n))})}gatewayErrorsListener(e){return C(this,void 0,void 0,function*(){throw new I(`Bridge error ${JSON.stringify(e)}`)})}updateSession(e,n){return C(this,void 0,void 0,function*(){this.session=Object.assign(Object.assign({},this.session),{walletPublicKey:n});const c=e.payload.items.find(h=>h.name==="ton_addr"),f=Object.assign(Object.assign({},e),{payload:Object.assign(Object.assign({},e.payload),{items:[c]})});yield this.connectionStorage.storeConnection({type:"http",session:this.session,lastWalletEventId:e.id,connectEvent:f,nextRpcRequestId:0})})}removeBridgeAndSession(){return C(this,void 0,void 0,function*(){this.closeConnection(),yield this.connectionStorage.removeConnection()})}generateUniversalLink(e,n){return _r(e)?this.generateTGUniversalLink(e,n):this.generateRegularUniversalLink(e,n)}generateRegularUniversalLink(e,n){const c=new URL(e);return c.searchParams.append("v",Yn.toString()),c.searchParams.append("id",this.session.sessionCrypto.sessionId),c.searchParams.append("r",JSON.stringify(n)),c.toString()}generateTGUniversalLink(e,n){const f=this.generateRegularUniversalLink("about:blank",n).split("?")[1],h="tonconnect-"+Sr(f),x=this.convertToDirectLink(e),v=new URL(x);return v.searchParams.append("startapp",h),v.toString()}convertToDirectLink(e){const n=new URL(e);return n.searchParams.has("attach")&&(n.searchParams.delete("attach"),n.pathname+="/start"),n.toString()}openGateways(e,n){return C(this,void 0,void 0,function*(){if(Array.isArray(this.walletConnectionSource)){this.pendingGateways.map(c=>c.close().catch()),this.pendingGateways=this.walletConnectionSource.map(c=>{const f=new Zt(this.storage,c.bridgeUrl,e.sessionId,()=>{},()=>{});return f.setListener(h=>this.pendingGatewaysListener(f,c.bridgeUrl,h)),f}),yield Promise.allSettled(this.pendingGateways.map(c=>Ze(f=>{var h;return this.pendingGateways.some(x=>x===c)?c.registerSession({openingDeadlineMS:(h=n?.openingDeadlineMS)!==null&&h!==void 0?h:this.defaultOpeningDeadlineMS,signal:f.signal}):c.close()},{attempts:Number.MAX_SAFE_INTEGER,delayMs:this.defaultRetryTimeoutMS,signal:n?.signal})));return}else return this.gateway&&(le("Gateway is already opened, closing previous gateway"),yield this.gateway.close()),this.gateway=new Zt(this.storage,this.walletConnectionSource.bridgeUrl,e.sessionId,this.gatewayListener.bind(this),this.gatewayErrorsListener.bind(this)),yield this.gateway.registerSession({openingDeadlineMS:n?.openingDeadlineMS,signal:n?.signal})})}closeGateways(e){var n;(n=this.gateway)===null||n===void 0||n.close(),this.pendingGateways.filter(c=>c!==e?.except).forEach(c=>c.close()),this.pendingGateways=[]}}function Nn(i,e){return Gn(i,[e])}function Gn(i,e){return!i||typeof i!="object"?!1:e.every(n=>n in i)}function kr(i){try{return!Nn(i,"tonconnect")||!Nn(i.tonconnect,"walletInfo")?!1:Gn(i.tonconnect.walletInfo,["name","app_name","image","about_url","platforms"])}catch{return!1}}class $e{static getInstance(){return $e.instance||($e.instance=new $e),$e.instance}constructor(){this.storage={}}get length(){return Object.keys(this.storage).length}clear(){this.storage={}}getItem(e){var n;return(n=this.storage[e])!==null&&n!==void 0?n:null}key(e){var n;const c=Object.keys(this.storage);return e<0||e>=c.length?null:(n=c[e])!==null&&n!==void 0?n:null}removeItem(e){delete this.storage[e]}setItem(e,n){this.storage[e]=n}}function Ut(){if(!(typeof window>"u"))return window}function jr(){if(!(typeof document>"u"))return document}function Ir(){var i;const e=(i=Ut())===null||i===void 0?void 0:i.location.origin;return e?e+"/tonconnect-manifest.json":""}function Lr(){if(Mr())return localStorage;if(Wr())throw new I("`localStorage` is unavailable, but it is required for TonConnect. For more details, see https://github.com/ton-connect/sdk/tree/main/packages/sdk#init-connector");return $e.getInstance()}function Mr(){try{return typeof localStorage<"u"}catch{return!1}}function Wr(){return typeof process<"u"&&process.versions!=null&&process.versions.node!=null}function Br(){try{return typeof window<"u"&&window.location?window.location.hostname:null}catch{return null}}function Nr(){const i=Ut();if(!i)return[];try{return Object.entries(i)}catch{return[]}}class be{static fromStorage(e){return C(this,void 0,void 0,function*(){const c=yield new et(e).getInjectedConnection();return new be(e,c.jsBridgeKey)})}static isWalletInjected(e){return be.isWindowContainsWallet(this.window,e)}static isInsideWalletBrowser(e){return be.isWindowContainsWallet(this.window,e)?this.window[e].tonconnect.isWalletBrowser:!1}static getCurrentlyInjectedWallets(){return this.window?Nr().filter(([c,f])=>kr(f)).map(([c,f])=>({name:f.tonconnect.walletInfo.name,appName:f.tonconnect.walletInfo.app_name,aboutUrl:f.tonconnect.walletInfo.about_url,imageUrl:f.tonconnect.walletInfo.image,tondns:f.tonconnect.walletInfo.tondns,jsBridgeKey:c,injected:!0,embedded:f.tonconnect.isWalletBrowser,platforms:f.tonconnect.walletInfo.platforms,features:f.tonconnect.walletInfo.features})):[]}static isWindowContainsWallet(e,n){return!!e&&n in e&&typeof e[n]=="object"&&"tonconnect"in e[n]}constructor(e,n){this.injectedWalletKey=n,this.type="injected",this.unsubscribeCallback=null,this.listenSubscriptions=!1,this.listeners=[];const c=be.window;if(!be.isWindowContainsWallet(c,n))throw new cn;this.connectionStorage=new et(e),this.injectedWallet=c[n].tonconnect}connect(e){this._connect(Yn,e)}restoreConnection(){return C(this,void 0,void 0,function*(){try{le("Injected Provider restoring connection...");const e=yield this.injectedWallet.restoreConnection();le("Injected Provider restoring connection response",e),e.event==="connect"?(this.makeSubscriptions(),this.listeners.forEach(n=>n(e))):yield this.connectionStorage.removeConnection()}catch(e){yield this.connectionStorage.removeConnection(),console.error(e)}})}closeConnection(){this.listenSubscriptions&&this.injectedWallet.disconnect(),this.closeAllListeners()}disconnect(){return C(this,void 0,void 0,function*(){return new Promise(e=>{const n=()=>{this.closeAllListeners(),this.connectionStorage.removeConnection().then(e)};try{this.injectedWallet.disconnect(),n()}catch(c){le(c),this.sendRequest({method:"disconnect",params:[]},n)}})})}closeAllListeners(){var e;this.listenSubscriptions=!1,this.listeners=[],(e=this.unsubscribeCallback)===null||e===void 0||e.call(this)}listen(e){return this.listeners.push(e),()=>this.listeners=this.listeners.filter(n=>n!==e)}sendRequest(e,n){return C(this,void 0,void 0,function*(){var c;const f={};typeof n=="function"?f.onRequestSent=n:(f.onRequestSent=n?.onRequestSent,f.signal=n?.signal);const h=(yield this.connectionStorage.getNextRpcRequestId()).toString();yield this.connectionStorage.increaseNextRpcRequestId(),le("Send injected-bridge request:",Object.assign(Object.assign({},e),{id:h}));const x=this.injectedWallet.send(Object.assign(Object.assign({},e),{id:h}));return x.then(v=>le("Wallet message received:",v)),(c=f?.onRequestSent)===null||c===void 0||c.call(f),x})}_connect(e,n){return C(this,void 0,void 0,function*(){try{le(`Injected Provider connect request: protocolVersion: ${e}, message:`,n);const c=yield this.injectedWallet.connect(e,n);le("Injected Provider connect response:",c),c.event==="connect"&&(yield this.updateSession(),this.makeSubscriptions()),this.listeners.forEach(f=>f(c))}catch(c){le("Injected Provider connect error:",c);const f={event:"connect_error",payload:{code:0,message:c?.toString()}};this.listeners.forEach(h=>h(f))}})}makeSubscriptions(){this.listenSubscriptions=!0,this.unsubscribeCallback=this.injectedWallet.listen(e=>{le("Wallet message received:",e),this.listenSubscriptions&&this.listeners.forEach(n=>n(e)),e.event==="disconnect"&&this.disconnect()})}updateSession(){return this.connectionStorage.storeConnection({type:"injected",jsBridgeKey:this.injectedWalletKey,nextRpcRequestId:0})}}be.window=Ut();class Kr{constructor(){this.localStorage=Lr()}getItem(e){return C(this,void 0,void 0,function*(){return this.localStorage.getItem(e)})}removeItem(e){return C(this,void 0,void 0,function*(){this.localStorage.removeItem(e)})}setItem(e,n){return C(this,void 0,void 0,function*(){this.localStorage.setItem(e,n)})}}function Dr(i){return qr(i)&&i.injected}function Or(i){return Dr(i)&&i.embedded}function qr(i){return"jsBridgeKey"in i}const Fr=[{app_name:"telegram-wallet",name:"Wallet",image:"https://wallet.tg/images/logo-288.png",about_url:"https://wallet.tg/",universal_url:"https://t.me/wallet?attach=wallet",bridge:[{type:"sse",url:"https://walletbot.me/tonconnect-bridge/bridge"}],platforms:["ios","android","macos","windows","linux"],features:[{name:"SendTransaction",maxMessages:255,extraCurrencySupported:!0},{name:"SignData",types:["text","binary","cell"]}]},{app_name:"tonkeeper",name:"Tonkeeper",image:"https://tonkeeper.com/assets/tonconnect-icon.png",tondns:"tonkeeper.ton",about_url:"https://tonkeeper.com",universal_url:"https://app.tonkeeper.com/ton-connect",deepLink:"tonkeeper-tc://",bridge:[{type:"sse",url:"https://bridge.tonapi.io/bridge"},{type:"js",key:"tonkeeper"}],platforms:["ios","android","chrome","firefox","macos"],features:[{name:"SendTransaction",maxMessages:255,extraCurrencySupported:!0},{name:"SignData",types:["text","binary","cell"]}]},{app_name:"mytonwallet",name:"MyTonWallet",image:"https://static.mytonwallet.io/icon-256.png",about_url:"https://mytonwallet.io",universal_url:"https://connect.mytonwallet.org",deepLink:"mytonwallet-tc://",bridge:[{type:"js",key:"mytonwallet"},{type:"sse",url:"https://tonconnectbridge.mytonwallet.org/bridge/"}],platforms:["chrome","windows","macos","linux","ios","android","firefox"],features:[{name:"SendTransaction",maxMessages:255,extraCurrencySupported:!1},{name:"SignData",types:["text","binary","cell"]}]},{app_name:"tonhub",name:"Tonhub",image:"https://tonhub.com/tonconnect_logo.png",about_url:"https://tonhub.com",universal_url:"https://tonhub.com/ton-connect",bridge:[{type:"js",key:"tonhub"},{type:"sse",url:"https://connect.tonhubapi.com/tonconnect"}],platforms:["ios","android"],features:[{name:"SendTransaction",maxMessages:255,extraCurrencySupported:!0},{name:"SignData",types:["text","binary","cell"]}]},{app_name:"bitgetTonWallet",name:"Bitget Wallet",image:"https://raw.githubusercontent.com/bitgetwallet/download/refs/heads/main/logo/png/bitget_wallet_logo_288_mini.png",about_url:"https://web3.bitget.com",deepLink:"bitkeep://",bridge:[{type:"js",key:"bitgetTonWallet"},{type:"sse",url:"https://ton-connect-bridge.bgwapi.io/bridge"}],platforms:["ios","android","chrome"],universal_url:"https://bkcode.vip/ton-connect",features:[{name:"SendTransaction",maxMessages:4,extraCurrencySupported:!1}]},{app_name:"okxMiniWallet",name:"OKX Mini Wallet",image:"https://static.okx.com/cdn/assets/imgs/2411/8BE1A4A434D8F58A.png",about_url:"https://www.okx.com/web3",universal_url:"https://t.me/OKX_WALLET_BOT?attach=wallet",bridge:[{type:"sse",url:"https://www.okx.com/tonbridge/discover/rpc/bridge"}],platforms:["ios","android","macos","windows","linux"],features:[{name:"SendTransaction",maxMessages:4,extraCurrencySupported:!1}]},{app_name:"binanceWeb3TonWallet",name:"Binance Wallet",image:"https://public.bnbstatic.com/static/binance-w3w/ton-provider/binancew3w.png",about_url:"https://www.binance.com/en/web3wallet",deepLink:"bnc://app.binance.com/cedefi/ton-connect",bridge:[{type:"js",key:"binancew3w"},{type:"sse",url:"https://wallet.binance.com/tonbridge/bridge"}],platforms:["ios","android","macos","windows","linux"],universal_url:"https://app.binance.com/cedefi/ton-connect",features:[{name:"SendTransaction",maxMessages:4,extraCurrencySupported:!1}]},{app_name:"fintopio-tg",name:"Fintopio",image:"https://raw.githubusercontent.com/fintopio/ton-pub/refs/heads/main/logos/tonconnect-icon.png",about_url:"https://fintopio.com",universal_url:"https://t.me/fintopio?attach=wallet",bridge:[{type:"sse",url:"https://wallet-bridge.fintopio.com/bridge"}],platforms:["ios","android","macos","windows","linux"],features:[{name:"SendTransaction",maxMessages:4,extraCurrencySupported:!1}]},{app_name:"okxTonWallet",name:"OKX Wallet",image:"https://static.okx.com/cdn/assets/imgs/247/58E63FEA47A2B7D7.png",about_url:"https://www.okx.com/web3",universal_url:"https://www.okx.com/download?appendQuery=true&deeplink=okx://web3/wallet/tonconnect",bridge:[{type:"js",key:"okxTonWallet"},{type:"sse",url:"https://www.okx.com/tonbridge/discover/rpc/bridge"}],platforms:["chrome","safari","firefox","ios","android"],features:[{name:"SendTransaction",maxMessages:4,extraCurrencySupported:!1}]},{app_name:"hot",name:"HOT",image:"https://raw.githubusercontent.com/hot-dao/media/main/logo.png",about_url:"https://hot-labs.org/",universal_url:"https://t.me/herewalletbot?attach=wallet",bridge:[{type:"sse",url:"https://sse-bridge.hot-labs.org"},{type:"js",key:"hotWallet"}],platforms:["ios","android","macos","windows","linux"],features:[{name:"SendTransaction",maxMessages:4,extraCurrencySupported:!1}]},{app_name:"bybitTonWallet",name:"Bybit Wallet",image:"https://raw.githubusercontent.com/bybit-web3/bybit-web3.github.io/main/docs/images/bybit-logo.png",about_url:"https://www.bybit.com/web3",universal_url:"https://app.bybit.com/ton-connect",deepLink:"bybitapp://",bridge:[{type:"js",key:"bybitTonWallet"},{type:"sse",url:"https://api-node.bybit.com/spot/api/web3/bridge/ton/bridge"}],platforms:["ios","android","chrome"],features:[{name:"SendTransaction",maxMessages:4,extraCurrencySupported:!1}]},{app_name:"dewallet",name:"DeWallet",image:"https://raw.githubusercontent.com/delab-team/manifests-images/main/WalletAvatar.png",about_url:"https://delabwallet.com",universal_url:"https://t.me/dewallet?attach=wallet",bridge:[{type:"sse",url:"https://bridge.dewallet.pro/bridge"}],platforms:["ios","android","macos","windows","linux"],features:[{name:"SendTransaction",maxMessages:4,extraCurrencySupported:!1}]},{app_name:"safepalwallet",name:"SafePal",image:"https://s.pvcliping.com/web/public_image/SafePal_x288.png",tondns:"",about_url:"https://www.safepal.com",universal_url:"https://link.safepal.io/ton-connect",deepLink:"safepal-tc://",bridge:[{type:"sse",url:"https://ton-bridge.safepal.com/tonbridge/v1/bridge"},{type:"js",key:"safepalwallet"}],platforms:["ios","android","chrome","firefox"],features:[{name:"SendTransaction",maxMessages:1,extraCurrencySupported:!1}]},{app_name:"GateWallet",name:"GateWallet",image:"https://img.gatedataimg.com/prd-ordinal-imgs/036f07bb8730716e/gateio-0925.png",about_url:"https://www.gate.io/",bridge:[{type:"js",key:"gatetonwallet"},{type:"sse",url:"https://dapp.gateio.services/tonbridge_api/bridge/v1"}],platforms:["ios","android"],universal_url:"https://gate.onelink.me/Hls0/web3?gate_web3_wallet_universal_type=ton_connect",features:[{name:"SendTransaction",maxMessages:4,extraCurrencySupported:!1}]},{app_name:"openmask",name:"OpenMask",image:"https://raw.githubusercontent.com/OpenProduct/openmask-extension/main/public/openmask-logo-288.png",about_url:"https://www.openmask.app/",bridge:[{type:"js",key:"openmask"}],platforms:["chrome"],features:[{name:"SendTransaction",maxMessages:4,extraCurrencySupported:!1}]},{app_name:"BitgetWeb3",name:"BitgetWeb3",image:"https://img.bitgetimg.com/image/third/1731638059795.png",about_url:"https://www.bitget.com",universal_url:"https://t.me/BitgetOfficialBot?attach=wallet",bridge:[{type:"sse",url:"https://ton-connect-bridge.bgwapi.io/bridge"}],platforms:["ios","android","windows","macos","linux"],features:[{name:"SendTransaction",maxMessages:4,extraCurrencySupported:!1}]},{app_name:"xtonwallet",name:"XTONWallet",image:"https://xtonwallet.com/assets/img/icon-256-back.png",about_url:"https://xtonwallet.com",bridge:[{type:"js",key:"xtonwallet"}],platforms:["chrome","firefox"],features:[{name:"SendTransaction",maxMessages:1,extraCurrencySupported:!1}]},{app_name:"tonwallet",name:"TON Wallet",image:"https://wallet.ton.org/assets/ui/qr-logo.png",about_url:"https://chrome.google.com/webstore/detail/ton-wallet/nphplpgoakhhjchkkhmiggakijnkhfnd",bridge:[{type:"js",key:"tonwallet"}],platforms:["chrome"],features:[{name:"SendTransaction",maxMessages:4,extraCurrencySupported:!1}]},{app_name:"bitgetWalletLite",name:"Bitget Wallet Lite",image:"https://raw.githubusercontent.com/bitgetwallet/download/refs/heads/main/logo/png/bitget_wallet_lite_logo_288.png",about_url:"https://web3.bitget.com",universal_url:"https://t.me/BitgetWallet_TGBot?attach=wallet",bridge:[{type:"sse",url:"https://ton-connect-bridge.bgwapi.io/bridge"}],platforms:["ios","android","macos","windows","linux"],features:[{name:"SendTransaction",maxMessages:255,extraCurrencySupported:!1}]},{app_name:"tomoWallet",name:"Tomo Wallet",image:"https://pub.tomo.inc/logo.png",about_url:"https://www.tomo.inc/",universal_url:"https://t.me/tomowalletbot?attach=wallet",bridge:[{type:"sse",url:"https://go-bridge.tomo.inc/bridge"}],platforms:["ios","android","macos","windows","linux"],features:[{name:"SendTransaction",maxMessages:4,extraCurrencySupported:!1}]},{app_name:"miraiapp-tg",name:"Mirai Mini App",image:"https://cdn.mirailabs.co/miraihub/miraiapp-tg-icon-288.png",about_url:"https://mirai.app",universal_url:"https://t.me/MiraiAppBot?attach=wallet",bridge:[{type:"sse",url:"https://bridge.mirai.app"}],platforms:["ios","android","macos","windows","linux"],features:[{name:"SendTransaction",maxMessages:255,extraCurrencySupported:!1},{name:"SignData",types:["text","binary","cell"]}]},{app_name:"Architec.ton",name:"Architec.ton",image:"https://raw.githubusercontent.com/Architec-Ton/wallet-tma/refs/heads/dev/public/images/arcwallet_logo.png",about_url:"https://architecton.tech",universal_url:"https://t.me/architec_ton_bot?attach=wallet",bridge:[{type:"sse",url:"https://tc.architecton.su/bridge"}],platforms:["ios","android","macos","windows","linux"],features:[{name:"SendTransaction",maxMessages:255,extraCurrencySupported:!1}]},{app_name:"tokenpocket",name:"TokenPocket",image:"https://hk.tpstatic.net/logo/tokenpocket.png",about_url:"https://www.tokenpocket.pro",universal_url:"https://tp-lab.tptool.pro/ton-connect/",bridge:[{type:"js",key:"tokenpocket"},{type:"sse",url:"https://ton-connect.mytokenpocket.vip/bridge"}],platforms:["ios","android"],features:[{name:"SendTransaction",maxMessages:4,extraCurrencySupported:!1}]},{app_name:"uxuyWallet",name:"UXUY Wallet",image:"https://chain-cdn.uxuy.com/logo/square_288.png",about_url:"https://docs.uxuy.com",universal_url:"https://t.me/UXUYbot?attach=wallet",bridge:[{type:"sse",url:"https://bridge.uxuy.me/bridge"}],platforms:["ios","android","macos","windows","linux"],features:[{name:"SendTransaction",maxMessages:4,extraCurrencySupported:!1}]},{app_name:"tonkeeper-pro",name:"Tonkeeper Pro",image:"https://tonkeeper.com/assets/tonconnect-icon-pro.png",tondns:"tonkeeper.ton",about_url:"https://tonkeeper.com/pro",universal_url:"https://app.tonkeeper.com/pro/ton-connect",deepLink:"tonkeeper-pro-tc://",bridge:[{type:"sse",url:"https://bridge.tonapi.io/bridge"}],platforms:["ios","macos","windows","linux"],features:[{name:"SendTransaction",maxMessages:255,extraCurrencySupported:!0},{name:"SignData",types:["text","binary","cell"]}]},{app_name:"nicegramWallet",name:"Nicegram Wallet",image:"https://static.nicegram.app/icon.png",about_url:"https://nicegram.app",universal_url:"https://nicegram.app/tc",deepLink:"nicegram-tc://",bridge:[{type:"sse",url:"https://tc.nicegram.app/bridge"},{type:"js",key:"nicegramWallet"}],platforms:["ios","android"],features:[{name:"SendTransaction",maxMessages:255,extraCurrencySupported:!1}]},{app_name:"echoooTonWallet",name:"EchoooWallet",image:"https://cdn.echooo.xyz/front-end/source/images/logo/echooo-ton.png",about_url:"https://www.echooo.xyz",universal_url:"https://www.echooo.xyz/ton-connect",deepLink:"echooo://",bridge:[{type:"js",key:"echoooTonWallet"},{type:"sse",url:"https://ton-connect-bridge.echooo.link/bridge"}],platforms:["ios","android"],features:[{name:"SendTransaction",maxMessages:255,extraCurrencySupported:!1}]},{app_name:"blitzwallet",name:"BLITZ wallet",image:"https://blitzwallet.cfd/wallet/public/logo.png",about_url:"https://blitzwallet.cfd",universal_url:"https://t.me/blitz_wallet_bot?attach=wallet",bridge:[{type:"sse",url:"https://blitzwallet.cfd/bridge/"}],platforms:["ios","android","macos","windows","linux"],features:[{name:"SendTransaction",maxMessages:4,extraCurrencySupported:!1}]},{app_name:"koloWeb3Wallet",name:"Kolo",image:"https://raw.githubusercontent.com/onidev1/tc-assets/refs/heads/main/kolo_logo_288.png",about_url:"https://kolo.xyz",universal_url:"https://t.me/kolo?attach=wallet",bridge:[{type:"sse",url:"https://web3-bridge.kolo.in/bridge"}],platforms:["ios","android","macos","windows","linux"],features:[{name:"SendTransaction",maxMessages:255,extraCurrencySupported:!1}]},{app_name:"imToken",name:"imToken",image:"https://aws-v2-cdn.token.im/orbit/token-v2/icons/logo-ton-connect.png",about_url:"https://token.im",universal_url:"https://connect.token.im/link/ton-connect",deepLink:"imtokenv2://link/ton-connect",bridge:[{type:"sse",url:"https://connect.token.im/tonbridge"},{type:"js",key:"imToken"}],platforms:["ios","android"],features:[{name:"SendTransaction",maxMessages:255,extraCurrencySupported:!1}]},{app_name:"cactuslink",name:"Cactus Link",image:"https://downloads.mycactus.com/288_cactus_link.png",about_url:"https://www.mycactus.com/defi-connector",bridge:[{type:"js",key:"cactuslink_ton"}],platforms:["chrome"],features:[{name:"SendTransaction",maxMessages:4,extraCurrencySupported:!1},{name:"SignData",types:["text","binary"]}]},{app_name:"onekey",name:"OneKey",image:"https://uni.onekey-asset.com/static/logo/onekey-x288.png",about_url:"https://onekey.so",bridge:[{type:"js",key:"onekeyTonWallet"}],platforms:["chrome"],features:[{name:"SendTransaction",maxMessages:4,extraCurrencySupported:!1}]}];class en{constructor(e){var n;this.walletsListDTOCache=null,this.walletsListDTOCacheCreationTimestamp=null,this.walletsListSource=(n=e?.walletsListSource)!==null&&n!==void 0?n:"https://config.ton.org/wallets-v2.json",this.cacheTTLMs=e?.cacheTTLMs}getWallets(){return C(this,void 0,void 0,function*(){const[e,n]=yield Promise.all([this.fetchWalletsListDTO(),this.getCurrentlyInjectedWallets()]);return this.mergeWalletsLists(this.walletConfigDTOListToWalletConfigList(e),n)})}getEmbeddedWallet(){return C(this,void 0,void 0,function*(){const n=(yield this.getWallets()).filter(Or);return n.length===1?n[0]:null})}fetchWalletsListDTO(){return C(this,void 0,void 0,function*(){return this.cacheTTLMs&&this.walletsListDTOCacheCreationTimestamp&&Date.now()>this.walletsListDTOCacheCreationTimestamp+this.cacheTTLMs&&(this.walletsListDTOCache=null),this.walletsListDTOCache||(this.walletsListDTOCache=this.fetchWalletsListFromSource(),this.walletsListDTOCache.then(()=>{this.walletsListDTOCacheCreationTimestamp=Date.now()}).catch(()=>{this.walletsListDTOCache=null,this.walletsListDTOCacheCreationTimestamp=null})),this.walletsListDTOCache})}fetchWalletsListFromSource(){return C(this,void 0,void 0,function*(){let e=[];try{if(e=yield(yield fetch(this.walletsListSource)).json(),!Array.isArray(e))throw new ln("Wrong wallets list format, wallets list must be an array.");const c=e.filter(f=>!this.isCorrectWalletConfigDTO(f));c.length&&(Ie(`Wallet(s) ${c.map(f=>f?.name||"unknown").join(", ")} config format is wrong. They were removed from the wallets list.`),e=e.filter(f=>this.isCorrectWalletConfigDTO(f)))}catch(n){Ie(n),e=Fr}return e})}getCurrentlyInjectedWallets(){return[]}walletConfigDTOListToWalletConfigList(e){return e.map(n=>{const c={name:n.name,appName:n.app_name,imageUrl:n.image,aboutUrl:n.about_url,tondns:n.tondns,platforms:n.platforms,features:n.features};return n.bridge.forEach(f=>{if(f.type==="sse"&&(c.bridgeUrl=f.url,c.universalLink=n.universal_url,c.deepLink=n.deepLink),f.type==="js"){const h=f.key;c.jsBridgeKey=h,c.injected=be.isWalletInjected(h),c.embedded=be.isInsideWalletBrowser(h)}}),c})}mergeWalletsLists(e,n){return[...new Set(e.concat(n).map(f=>f.name)).values()].map(f=>{const h=e.find(v=>v.name===f),x=n.find(v=>v.name===f);return Object.assign(Object.assign({},h&&Object.assign({},h)),x&&Object.assign({},x))})}isCorrectWalletConfigDTO(e){if(!e||typeof e!="object")return!1;const n="name"in e,c="app_name"in e,f="image"in e,h="about_url"in e,x="platforms"in e;if(!n||!f||!h||!x||!c||!e.platforms||!Array.isArray(e.platforms)||!e.platforms.length||!("bridge"in e)||!Array.isArray(e.bridge)||!e.bridge.length)return!1;const v=e.bridge;if(v.some(re=>!re||typeof re!="object"||!("type"in re)))return!1;const M=v.find(re=>re.type==="sse");if(M&&(!(typeof M=="object"&&"url"in M)||!M.url||!e.universal_url))return!1;const B=v.find(re=>re.type==="js");return!(B&&(typeof B!="object"||!("key"in B)||!B.key))}}function $r(i,e){const n=i.includes("SendTransaction"),c=tn(i,"SendTransaction"),f={minMessages:e.requiredMessagesNumber,extraCurrencyRequired:e.requireExtraCurrencies};if(!n&&!c)throw new Be("Wallet doesn't support SendTransaction feature.",{cause:{requiredFeature:{featureName:"SendTransaction",value:f}}});if(e.requireExtraCurrencies&&(!c||!c.extraCurrencySupported))throw new Be("Wallet is not able to handle such SendTransaction request. Extra currencies support is required.",{cause:{requiredFeature:{featureName:"SendTransaction",value:f}}});if(c&&c.maxMessages!==void 0){if(c.maxMessages<e.requiredMessagesNumber)throw new Be(`Wallet is not able to handle such SendTransaction request. Max support messages number is ${c.maxMessages}, but ${e.requiredMessagesNumber} is required.`,{cause:{requiredFeature:{featureName:"SendTransaction",value:f}}});return}Er("Connected wallet didn't provide information about max allowed messages in the SendTransaction request. Request may be rejected by the wallet.")}function Yr(i,e){const n=i.find(f=>f&&typeof f=="object"&&f.name==="SignData");if(!n)throw new Be("Wallet doesn't support SignData feature.",{cause:{requiredFeature:{featureName:"SignData",value:{types:e.requiredTypes}}}});const c=e.requiredTypes.filter(f=>!n.types.includes(f));if(c.length)throw new Be(`Wallet doesn't support required SignData types: ${c.join(", ")}.`,{cause:{requiredFeature:{featureName:"SignData",value:{types:c}}}})}function Gr(i,e){if(typeof e!="object")return!0;const{sendTransaction:n,signData:c}=e;if(n){const f=tn(i,"SendTransaction");if(!f||!Hr(f,n))return!1}if(c){const f=tn(i,"SignData");if(!f||!zr(f,c))return!1}return!0}function tn(i,e){return i.find(n=>n&&typeof n=="object"&&n.name===e)}function Hr(i,e){const n=e.minMessages===void 0||e.minMessages<=i.maxMessages,c=!e.extraCurrencyRequired||i.extraCurrencySupported;return!!(n&&c)}function zr(i,e){return e.types.every(n=>i.types.includes(n))}function Jr(){return{type:"request-version"}}function Xr(i){return{type:"response-version",version:i}}function Ye(i){return{ton_connect_sdk_lib:i.ton_connect_sdk_lib,ton_connect_ui_lib:i.ton_connect_ui_lib}}function ke(i,e){var n,c,f,h,x,v,M,B;const X=((n=e?.connectItems)===null||n===void 0?void 0:n.tonProof)&&"proof"in e.connectItems.tonProof?"ton_proof":"ton_addr";return{wallet_address:(f=(c=e?.account)===null||c===void 0?void 0:c.address)!==null&&f!==void 0?f:null,wallet_type:(h=e?.device.appName)!==null&&h!==void 0?h:null,wallet_version:(x=e?.device.appVersion)!==null&&x!==void 0?x:null,auth_type:X,custom_data:Object.assign({chain_id:(M=(v=e?.account)===null||v===void 0?void 0:v.chain)!==null&&M!==void 0?M:null,provider:(B=e?.provider)!==null&&B!==void 0?B:null},Ye(i))}}function Zr(i){return{type:"connection-started",custom_data:Ye(i)}}function Vr(i,e){return Object.assign({type:"connection-completed",is_success:!0},ke(i,e))}function Qr(i,e,n){return{type:"connection-error",is_success:!1,error_message:e,error_code:n??null,custom_data:Ye(i)}}function ei(i){return{type:"connection-restoring-started",custom_data:Ye(i)}}function ti(i,e){return Object.assign({type:"connection-restoring-completed",is_success:!0},ke(i,e))}function ni(i,e){return{type:"connection-restoring-error",is_success:!1,error_message:e,custom_data:Ye(i)}}function dn(i,e){var n,c,f,h;return{valid_until:(n=String(e.validUntil))!==null&&n!==void 0?n:null,from:(h=(c=e.from)!==null&&c!==void 0?c:(f=i?.account)===null||f===void 0?void 0:f.address)!==null&&h!==void 0?h:null,messages:e.messages.map(x=>{var v,M;return{address:(v=x.address)!==null&&v!==void 0?v:null,amount:(M=x.amount)!==null&&M!==void 0?M:null}})}}function ri(i,e,n){return Object.assign(Object.assign({type:"transaction-sent-for-signature"},ke(i,e)),dn(e,n))}function ii(i,e,n,c){return Object.assign(Object.assign({type:"transaction-signed",is_success:!0,signed_transaction:c.boc},ke(i,e)),dn(e,n))}function oi(i,e,n,c,f){return Object.assign(Object.assign({type:"transaction-signing-failed",is_success:!1,error_message:c,error_code:f??null},ke(i,e)),dn(e,n))}function si(i,e,n){return Object.assign({type:"sign-data-request-initiated",data:n},ke(i,e))}function ai(i,e,n,c){return Object.assign({type:"sign-data-request-completed",is_success:!0,data:n,signed_data:c},ke(i,e))}function ci(i,e,n,c,f){return Object.assign({type:"sign-data-request-failed",is_success:!1,data:n,error_message:c,error_code:f??null},ke(i,e))}function fi(i,e,n){return Object.assign({type:"disconnection",scope:n},ke(i,e))}class li{constructor(){this.window=Ut()}dispatchEvent(e,n){return C(this,void 0,void 0,function*(){var c;const f=new CustomEvent(e,{detail:n});(c=this.window)===null||c===void 0||c.dispatchEvent(f)})}addEventListener(e,n,c){return C(this,void 0,void 0,function*(){var f;return(f=this.window)===null||f===void 0||f.addEventListener(e,n,c),()=>{var h;return(h=this.window)===null||h===void 0?void 0:h.removeEventListener(e,n)}})}}class di{get version(){return Ye({ton_connect_sdk_lib:this.tonConnectSdkVersion,ton_connect_ui_lib:this.tonConnectUiVersion})}constructor(e){var n;this.eventPrefix="ton-connect-",this.tonConnectUiVersion=null,this.eventDispatcher=(n=e?.eventDispatcher)!==null&&n!==void 0?n:new li,this.tonConnectSdkVersion=e.tonConnectSdkVersion,this.init().catch()}init(){return C(this,void 0,void 0,function*(){try{yield this.setRequestVersionHandler(),this.tonConnectUiVersion=yield this.requestTonConnectUiVersion()}catch{}})}setRequestVersionHandler(){return C(this,void 0,void 0,function*(){yield this.eventDispatcher.addEventListener("ton-connect-request-version",()=>C(this,void 0,void 0,function*(){yield this.eventDispatcher.dispatchEvent("ton-connect-response-version",Xr(this.tonConnectSdkVersion))}))})}requestTonConnectUiVersion(){return C(this,void 0,void 0,function*(){return new Promise((e,n)=>C(this,void 0,void 0,function*(){try{yield this.eventDispatcher.addEventListener("ton-connect-ui-response-version",c=>{e(c.detail.version)},{once:!0}),yield this.eventDispatcher.dispatchEvent("ton-connect-ui-request-version",Jr())}catch(c){n(c)}}))})}dispatchUserActionEvent(e){try{this.eventDispatcher.dispatchEvent(`${this.eventPrefix}${e.type}`,e).catch()}catch{}}trackConnectionStarted(...e){try{const n=Zr(this.version,...e);this.dispatchUserActionEvent(n)}catch{}}trackConnectionCompleted(...e){try{const n=Vr(this.version,...e);this.dispatchUserActionEvent(n)}catch{}}trackConnectionError(...e){try{const n=Qr(this.version,...e);this.dispatchUserActionEvent(n)}catch{}}trackConnectionRestoringStarted(...e){try{const n=ei(this.version,...e);this.dispatchUserActionEvent(n)}catch{}}trackConnectionRestoringCompleted(...e){try{const n=ti(this.version,...e);this.dispatchUserActionEvent(n)}catch{}}trackConnectionRestoringError(...e){try{const n=ni(this.version,...e);this.dispatchUserActionEvent(n)}catch{}}trackDisconnection(...e){try{const n=fi(this.version,...e);this.dispatchUserActionEvent(n)}catch{}}trackTransactionSentForSignature(...e){try{const n=ri(this.version,...e);this.dispatchUserActionEvent(n)}catch{}}trackTransactionSigned(...e){try{const n=ii(this.version,...e);this.dispatchUserActionEvent(n)}catch{}}trackTransactionSigningFailed(...e){try{const n=oi(this.version,...e);this.dispatchUserActionEvent(n)}catch{}}trackDataSentForSignature(...e){try{const n=si(this.version,...e);this.dispatchUserActionEvent(n)}catch{}}trackDataSigned(...e){try{const n=ai(this.version,...e);this.dispatchUserActionEvent(n)}catch{}}trackDataSigningFailed(...e){try{const n=ci(this.version,...e);this.dispatchUserActionEvent(n)}catch{}}}const ui="3.3.1",Kn=17,hi=81,Dn=128;function Hn(i){try{return gi(i),!0}catch{return!1}}function pi(i){try{return xi(i),!0}catch{return!1}}function gi(i){const e=i.replace(/-/g,"+").replace(/_/g,"/");let n;try{n=on.decode(e).toUint8Array()}catch{throw new Te(`Invalid base64 encoding in address: ${i}`)}if(n.length!==36)throw new Te(`Invalid address length: ${i}`);const c=n.slice(0,34),f=n.slice(34,36),h=vi(c);if(!f.every((X,de)=>X===h[de]))throw new Te(`Invalid checksum in address: ${i}`);let x=c[0],v=!1,M=!1;if(x&Dn&&(v=!0,x=x^Dn),x!==Kn&&x!==hi)throw new Te(`Unknown address tag: ${x}`);M=x===Kn;let B=null;c[1]===255?B=-1:B=c[1];const re=c.slice(2);if(B!==0&&B!==-1)throw new Te(`Invalid workchain: ${B}`);return{wc:B,hex:Array.from(re).map(X=>X.toString(16).padStart(2,"0")).join(""),testOnly:v,isBounceable:M}}function xi(i){if(!i.includes(":"))throw new Te(`Wrong address ${i}. Address must include ":".`);const e=i.split(":");if(e.length!==2)throw new Te(`Wrong address ${i}. Address must include ":" only once.`);const n=parseInt(e[0]);if(n!==0&&n!==-1)throw new Te(`Wrong address ${i}. WC must be eq 0 or -1, but ${n} received.`);const c=e[1];if(c?.length!==64)throw new Te(`Wrong address ${i}. Hex part must be 64bytes length, but ${c?.length} received.`);return{wc:n,hex:yi(c)}}function vi(i){let n=0;const c=new Uint8Array(i.length+2);c.set(i);for(let f of c){let h=128;for(;h>0;)n<<=1,f&h&&(n+=1),h>>=1,n>65535&&(n&=65535,n^=4129)}return new Uint8Array([Math.floor(n/256),n%256])}const nn={};for(let i=0;i<=255;i++){let e=i.toString(16);e.length<2&&(e="0"+e),nn[e]=i}function yi(i){i=i.toLowerCase();const e=i.length;if(e%2!==0)throw new Tt("Hex string must have length a multiple of 2: "+i);const n=e/2,c=new Uint8Array(n);for(let f=0;f<n;f++){const h=f*2,x=i.substring(h,h+2);if(!nn.hasOwnProperty(x))throw new Tt("Invalid hex character: "+x);c[f]=nn[x]}return c}const zn=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/,bi=/^[A-Za-z0-9\-_]+$/,mi="te6cc",wi=/^-?\d+$/,_i=/^\d+$/,Si=128,Ei=128,Ti=222;function wt(i){return typeof i=="number"&&!isNaN(i)}function ge(i){return typeof i=="string"&&i.length>0}function At(i){return ge(i)&&(pi(i)||Hn(i))}function Pt(i){return ge(i)&&/^-?\d+$/.test(i)}function rn(i){return typeof i=="string"&&(zn.test(i)||bi.test(i))&&i.startsWith(mi)}function Ae(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)}function Ci(i){return Array.isArray(i)}function Pe(i,e){return Object.keys(i).some(n=>!e.includes(n))}function Ri(i){if(!Ae(i))return"Request must be an object";if(Pe(i,["validUntil","network","from","messages"]))return"Request contains extra properties";if(i.validUntil){if(!wt(i.validUntil))return"Incorrect 'validUntil'";const n=Math.floor(Date.now()/1e3),c=n+300;i.validUntil>c&&console.warn(`validUntil (${i.validUntil}) is more than 5 minutes from now (${n})`)}if(i.network!==void 0&&!Pt(i.network))return"Invalid 'network' format";if(i.from!==void 0&&!At(i.from))return"Invalid 'from' address format";if(!Ci(i.messages)||i.messages.length===0)return"'messages' is required";for(let n=0;n<i.messages.length;n++){const c=i.messages[n],f=Ui(c,n);if(f)return f}return null}function Ui(i,e){if(!Ae(i))return`Message at index ${e} must be an object`;if(Pe(i,["address","amount","stateInit","payload","extraCurrency"]))return`Message at index ${e} contains extra properties`;if(!ge(i.address))return`'address' is required in message at index ${e}`;if(!Hn(i.address))return`Wrong 'address' format in message at index ${e}`;if(!ge(i.amount))return`'amount' is required in message at index ${e}`;if(!/^[0-9]+$/.test(i.amount))return`Incorrect 'amount' in message at index ${e}`;if(i.stateInit!==void 0&&(!ge(i.stateInit)||!rn(i.stateInit)))return`Invalid 'stateInit' in message at index ${e}`;if(i.payload!==void 0&&(!ge(i.payload)||!rn(i.payload)))return`Invalid 'payload' in message at index ${e}`;if(i.extraCurrency!==void 0){if(!Ae(i.extraCurrency))return`Invalid 'extraCurrency' in message at index ${e}`;for(const[c,f]of Object.entries(i.extraCurrency))if(!wi.test(c)||typeof f!="string"||!_i.test(f))return`Invalid 'extraCurrency' format in message at index ${e}`}return null}function Ai(i){if(!Ae(i))return"Request must be an object";if(Pe(i,["tonProof"]))return"Request contains extra properties";if(i.tonProof!==void 0){if(typeof i.tonProof!="string")return"Invalid 'tonProof'";const n=i.tonProof;if(n.length===0)return"Empty 'tonProof' payload";const c=Br();if(!c)return null;const f=new TextEncoder().encode(c).length;if(f>Si)return"Current domain exceeds 128 bytes limit";const h=new TextEncoder().encode(n).length;if(h>Ei)return"'tonProof' payload exceeds 128 bytes limit";if(f+h>Ti)return"'tonProof' domain + payload exceeds 222 bytes limit"}return null}function Pi(i){if(!Ae(i))return"Payload must be an object";if(!ge(i.type))return"'type' is required";switch(i.type){case"text":return ki(i);case"binary":return ji(i);case"cell":return Ii(i);default:return"Invalid 'type' value"}}function ki(i){return Pe(i,["type","text","network","from"])?"Text payload contains extra properties":ge(i.text)?i.network!==void 0&&!Pt(i.network)?"Invalid 'network' format":i.from!==void 0&&!At(i.from)?"Invalid 'from'":null:"'text' is required"}function ji(i){return Pe(i,["type","bytes","network","from"])?"Binary payload contains extra properties":ge(i.bytes)?i.network!==void 0&&!Pt(i.network)?"Invalid 'network' format":i.from!==void 0&&!At(i.from)?"Invalid 'from'":null:"'bytes' is required"}function Ii(i){return Pe(i,["type","schema","cell","network","from"])?"Cell payload contains extra properties":ge(i.schema)?ge(i.cell)?rn(i.cell)?i.network!==void 0&&!Pt(i.network)?"Invalid 'network' format":i.from!==void 0&&!At(i.from)?"Invalid 'from'":null:"Invalid 'cell' format (must be valid base64)":"'cell' is required":"'schema' is required"}function Li(i){if(!Ae(i))return"ton_proof item must be an object";if(Pe(i,["error","proof","name"]))return"ton_proof item contains extra properties";const n=Object.prototype.hasOwnProperty.call(i,"proof"),c=Object.prototype.hasOwnProperty.call(i,"error");if(!n&&!c)return"'ton_proof' item must contain either 'proof' or 'error'";if(n&&c)return"'ton_proof' item must contain either 'proof' or 'error', not both";if(n){const f=i.proof;if(!Ae(f))return"Invalid 'proof' object";if(Pe(f,["timestamp","domain","payload","signature"]))return"ton_proof item contains extra properties";if(!wt(f.timestamp))return"Invalid 'proof.timestamp'";const x=f.domain;if(!Ae(x))return"Invalid 'proof.domain'";if(!wt(x.lengthBytes))return"Invalid 'proof.domain.lengthBytes'";if(!ge(x.value))return"Invalid 'proof.domain.value'";try{if((typeof TextEncoder<"u"?new TextEncoder().encode(x.value).length:x.value.length)!==x.lengthBytes)return"'proof.domain.lengthBytes' does not match 'proof.domain.value'"}catch{}if(!ge(f.payload))return"Invalid 'proof.payload'";if(!ge(f.signature)||!zn.test(f.signature))return"Invalid 'proof.signature' format"}if(c){const f=i.error;if(!Ae(f))return"Invalid 'error' object";if(Pe(f,["code","message"]))return"ton_proof error contains extra properties";if(!wt(f.code))return"Invalid 'error.code'";if(!ge(f.message))return"Invalid 'error.message'"}return null}function Vt(i){if(typeof i!="string")return;const e=i.length+(4-i.length%4)%4;return i.replace(/-/g,"+").replace(/_/g,"/").padEnd(e,"=")}class un{static getWallets(){return this.walletsList.getWallets()}get connected(){return this._wallet!==null}get account(){var e;return((e=this._wallet)===null||e===void 0?void 0:e.account)||null}get wallet(){return this._wallet}set wallet(e){this._wallet=e,this.statusChangeSubscriptions.forEach(n=>n(this._wallet))}constructor(e){if(this.walletsList=new en,this._wallet=null,this.provider=null,this.statusChangeSubscriptions=[],this.statusChangeErrorSubscriptions=[],this.dappSettings={manifestUrl:e?.manifestUrl||Ir(),storage:e?.storage||new Kr},this.walletsRequiredFeatures=e?.walletsRequiredFeatures,this.walletsList=new en({walletsListSource:e?.walletsListSource,cacheTTLMs:e?.walletsListCacheTTLMs}),this.tracker=new di({eventDispatcher:e?.eventDispatcher,tonConnectSdkVersion:ui}),!this.dappSettings.manifestUrl)throw new sn("Dapp tonconnect-manifest.json must be specified if window.location.origin is undefined. See more https://github.com/ton-connect/docs/blob/main/requests-responses.md#app-manifest");this.bridgeConnectionStorage=new et(this.dappSettings.storage),e?.disableAutoPauseConnection||this.addWindowFocusAndBlurSubscriptions()}getWallets(){return this.walletsList.getWallets()}onStatusChange(e,n){return this.statusChangeSubscriptions.push(e),n&&this.statusChangeErrorSubscriptions.push(n),()=>{this.statusChangeSubscriptions=this.statusChangeSubscriptions.filter(c=>c!==e),n&&(this.statusChangeErrorSubscriptions=this.statusChangeErrorSubscriptions.filter(c=>c!==n))}}connect(e,n){var c,f;const h={};if(typeof n=="object"&&"tonProof"in n&&(h.request=n),typeof n=="object"&&("openingDeadlineMS"in n||"signal"in n||"request"in n)&&(h.request=n?.request,h.openingDeadlineMS=n?.openingDeadlineMS,h.signal=n?.signal),h.request){const v=Ai(h.request);if(v)throw new I("ConnectAdditionalRequest validation failed: "+v)}if(this.connected)throw new an;const x=we(h?.signal);if((c=this.abortController)===null||c===void 0||c.abort(),this.abortController=x,x.signal.aborted)throw new I("Connection was aborted");return(f=this.provider)===null||f===void 0||f.closeConnection(),this.provider=this.createProvider(e),x.signal.addEventListener("abort",()=>{var v;(v=this.provider)===null||v===void 0||v.closeConnection(),this.provider=null}),this.tracker.trackConnectionStarted(),this.provider.connect(this.createConnectRequest(h?.request),{openingDeadlineMS:h?.openingDeadlineMS,signal:x.signal})}restoreConnection(e){return C(this,void 0,void 0,function*(){var n,c;this.tracker.trackConnectionRestoringStarted();const f=we(e?.signal);if((n=this.abortController)===null||n===void 0||n.abort(),this.abortController=f,f.signal.aborted){this.tracker.trackConnectionRestoringError("Connection restoring was aborted");return}const[h,x]=yield Promise.all([this.bridgeConnectionStorage.storedConnectionType(),this.walletsList.getEmbeddedWallet()]);if(f.signal.aborted){this.tracker.trackConnectionRestoringError("Connection restoring was aborted");return}let v=null;try{switch(h){case"http":v=yield tt.fromStorage(this.dappSettings.storage);break;case"injected":v=yield be.fromStorage(this.dappSettings.storage);break;default:if(x)v=this.createProvider(x);else return}}catch{this.tracker.trackConnectionRestoringError("Provider is not restored"),yield this.bridgeConnectionStorage.removeConnection(),v?.closeConnection(),v=null;return}if(f.signal.aborted){v?.closeConnection(),this.tracker.trackConnectionRestoringError("Connection restoring was aborted");return}if(!v){Ie("Provider is not restored"),this.tracker.trackConnectionRestoringError("Provider is not restored");return}(c=this.provider)===null||c===void 0||c.closeConnection(),this.provider=v,v.listen(this.walletEventsListener.bind(this));const M=()=>{this.tracker.trackConnectionRestoringError("Connection restoring was aborted"),v?.closeConnection(),v=null};f.signal.addEventListener("abort",M);const B=Ze(X=>C(this,void 0,void 0,function*(){yield v?.restoreConnection({openingDeadlineMS:e?.openingDeadlineMS,signal:X.signal}),f.signal.removeEventListener("abort",M),this.connected?this.tracker.trackConnectionRestoringCompleted(this.wallet):this.tracker.trackConnectionRestoringError("Connection restoring failed")}),{attempts:Number.MAX_SAFE_INTEGER,delayMs:2e3,signal:e?.signal}),re=new Promise(X=>setTimeout(()=>X(),12e3));return Promise.race([B,re])})}sendTransaction(e,n){return C(this,void 0,void 0,function*(){const c={};typeof n=="function"?c.onRequestSent=n:(c.onRequestSent=n?.onRequestSent,c.signal=n?.signal);const f=Ri(e);if(f)throw new I("SendTransactionRequest validation failed: "+f);const h=we(c?.signal);if(h.signal.aborted)throw new I("Transaction sending was aborted");this.checkConnection();const x=e.messages.length,v=e.messages.some(_e=>_e.extraCurrency&&Object.keys(_e.extraCurrency).length>0);$r(this.wallet.device.features,{requiredMessagesNumber:x,requireExtraCurrencies:v}),this.tracker.trackTransactionSentForSignature(this.wallet,e);const{validUntil:M,messages:B}=e,re=Ln(e,["validUntil","messages"]),X=e.from||this.account.address,de=e.network||this.account.chain,xe=yield this.provider.sendRequest(yt.convertToRpcRequest(Object.assign(Object.assign({},re),{from:X,network:de,valid_until:M,messages:B.map(_e=>{var{extraCurrency:ot,payload:Ge,stateInit:kt}=_e,jt=Ln(_e,["extraCurrency","payload","stateInit"]);return Object.assign(Object.assign({},jt),{payload:Vt(Ge),stateInit:Vt(kt),extra_currency:ot})})})),{onRequestSent:c.onRequestSent,signal:h.signal});if(yt.isError(xe))return this.tracker.trackTransactionSigningFailed(this.wallet,e,xe.error.message,xe.error.code),yt.parseAndThrowError(xe);const ve=yt.convertFromRpcResponse(xe);return this.tracker.trackTransactionSigned(this.wallet,e,ve),ve})}signData(e,n){return C(this,void 0,void 0,function*(){const c=we(n?.signal);if(c.signal.aborted)throw new I("data sending was aborted");const f=Pi(e);if(f)throw new I("SignDataPayload validation failed: "+f);this.checkConnection(),Yr(this.wallet.device.features,{requiredTypes:[e.type]}),this.tracker.trackDataSentForSignature(this.wallet,e);const h=e.from||this.account.address,x=e.network||this.account.chain,v=yield this.provider.sendRequest(bt.convertToRpcRequest(Object.assign(Object.assign(Object.assign({},e),e.type==="cell"?{cell:Vt(e.cell)}:{}),{from:h,network:x})),{onRequestSent:n?.onRequestSent,signal:c.signal});if(bt.isError(v))return this.tracker.trackDataSigningFailed(this.wallet,e,v.error.message,v.error.code),bt.parseAndThrowError(v);const M=bt.convertFromRpcResponse(v);return this.tracker.trackDataSigned(this.wallet,e,M),M})}disconnect(e){return C(this,void 0,void 0,function*(){var n;if(!this.connected)throw new Et;const c=we(e?.signal),f=this.abortController;if(this.abortController=c,c.signal.aborted)throw new I("Disconnect was aborted");this.onWalletDisconnected("dapp"),yield(n=this.provider)===null||n===void 0?void 0:n.disconnect({signal:c.signal}),f?.abort()})}getSessionId(){return C(this,void 0,void 0,function*(){if(!this.provider||!this.connected)return null;try{const e=yield this.bridgeConnectionStorage.getConnection();return!e||e.type==="injected"?null:"sessionCrypto"in e?e.sessionCrypto.sessionId:e.session.sessionCrypto.sessionId}catch{return null}})}pauseConnection(){var e;((e=this.provider)===null||e===void 0?void 0:e.type)==="http"&&this.provider.pause()}unPauseConnection(){var e;return((e=this.provider)===null||e===void 0?void 0:e.type)!=="http"?Promise.resolve():this.provider.unPause()}addWindowFocusAndBlurSubscriptions(){const e=jr();if(e)try{e.addEventListener("visibilitychange",()=>{e.hidden?this.pauseConnection():this.unPauseConnection().catch(()=>{})})}catch(n){Ie("Cannot subscribe to the document.visibilitychange: ",n)}}createProvider(e){let n;return!Array.isArray(e)&&gr(e)?n=new be(this.dappSettings.storage,e.jsBridgeKey):n=new tt(this.dappSettings.storage,e),n.listen(this.walletEventsListener.bind(this)),n}walletEventsListener(e){switch(e.event){case"connect":this.onWalletConnected(e.payload);break;case"connect_error":this.tracker.trackConnectionError(e.payload.message,e.payload.code);const n=vr.parseError(e.payload);this.onWalletConnectError(n);break;case"disconnect":this.onWalletDisconnected("wallet")}}onWalletConnected(e){var n;const c=e.items.find(v=>v.name==="ton_addr"),f=e.items.find(v=>v.name==="ton_proof");if(!c)throw new I("ton_addr connection item was not found");if(!Gr(e.device.features,this.walletsRequiredFeatures)){(n=this.provider)===null||n===void 0||n.disconnect(),this.onWalletConnectError(new fn("Wallet does not support required features",{cause:{connectEvent:e}}));return}const x={device:e.device,provider:this.provider.type,account:{address:c.address,chain:c.network,walletStateInit:c.walletStateInit,publicKey:c.publicKey}};if(f){const v=Li(f);let M;if(v)M={name:"ton_proof",error:{code:_t.UNKNOWN_ERROR,message:v}};else try{if("proof"in f)M={name:"ton_proof",proof:{timestamp:f.proof.timestamp,domain:{lengthBytes:f.proof.domain.lengthBytes,value:f.proof.domain.value},payload:f.proof.payload,signature:f.proof.signature}};else if("error"in f)M={name:"ton_proof",error:{code:f.error.code,message:f.error.message}};else throw new I("Invalid data format")}catch{M={name:"ton_proof",error:{code:_t.UNKNOWN_ERROR,message:"Invalid data format"}}}x.connectItems={tonProof:M}}this.wallet=x,this.tracker.trackConnectionCompleted(x)}onWalletConnectError(e){if(this.statusChangeErrorSubscriptions.forEach(n=>n(e)),le(e),e instanceof Rt||e instanceof Ct)throw Ie(e),e}onWalletDisconnected(e){this.tracker.trackDisconnection(this.wallet,e),this.wallet=null}checkConnection(){if(!this.connected)throw new Et}createConnectRequest(e){const n=[{name:"ton_addr"}];return e?.tonProof&&n.push({name:"ton_proof",payload:e.tonProof}),{manifestUrl:this.dappSettings.manifestUrl,items:n}}}un.walletsList=new en;un.isWalletInjected=i=>be.isWalletInjected(i);un.isInsideWalletBrowser=i=>be.isInsideWalletBrowser(i);export{rt as BadRequestError,li as BrowserEventDispatcher,In as CHAIN,je as CONNECT_EVENT_ERROR_CODES,_t as CONNECT_ITEM_ERROR_CODES,ln as FetchWalletsError,Tt as ParseHexError,qe as SEND_TRANSACTION_ERROR_CODES,Fe as SIGN_DATA_ERROR_CODES,Qt as SessionCrypto,un as TonConnect,I as TonConnectError,it as UnknownAppError,Ce as UnknownError,nt as UserRejectsError,an as WalletAlreadyConnectedError,fn as WalletMissingRequiredFeaturesError,Et as WalletNotConnectedError,cn as WalletNotInjectedError,Be as WalletNotSupportFeatureError,en as WalletsListManager,Te as WrongAddressError,Gr as checkRequiredWalletFeatures,Vr as createConnectionCompletedEvent,Qr as createConnectionErrorEvent,ti as createConnectionRestoringCompletedEvent,ni as createConnectionRestoringErrorEvent,ei as createConnectionRestoringStartedEvent,Zr as createConnectionStartedEvent,si as createDataSentForSignatureEvent,ai as createDataSignedEvent,ci as createDataSigningFailedEvent,fi as createDisconnectionEvent,Jr as createRequestVersionEvent,Xr as createResponseVersionEvent,ri as createTransactionSentForSignatureEvent,ii as createTransactionSignedEvent,oi as createTransactionSigningFailedEvent,Ye as createVersionInfo,un as default,Sr as encodeTelegramUrlParameters,_r as isTelegramUrl,Or as isWalletInfoCurrentlyEmbedded,Dr as isWalletInfoCurrentlyInjected,qr as isWalletInfoInjectable};
